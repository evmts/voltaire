---
title: '[TS/JS] docs/skills/contract-interaction.test.ts'
source: 'docs/skills/contract-interaction.test.ts'
---

> Auto-generated from test file: docs/skills/contract-interaction.test.ts

```typescript
/**
 * Tests for contract interaction guide
 * @see /docs/guides/contract-interaction.mdx
 *
 * Note: The guide shows Contract abstraction patterns which are REFERENCE IMPLEMENTATIONS
 * not library exports. Tests cover the primitives that ARE available.
 *
 * API DISCREPANCIES:
 * - '@voltaire/contract' - DOES NOT EXIST as export. Guide notes this is a reference implementation
 * - Contract module is meant to be copied from examples/contract/ or docs
 * - Abi primitive IS available at src/primitives/Abi/
 */
import { describe, expect, it } from "vitest";

describe("Contract Interaction Guide", () => {
	it("should work with ERC-20 ABI definition", () => {
		// ERC-20 ABI from guide
		const erc20Abi = [
			{
				type: "function",
				name: "name",
				stateMutability: "view",
				inputs: [],
				outputs: [{ type: "string", name: "" }],
			},
			{
				type: "function",
				name: "symbol",
				stateMutability: "view",
				inputs: [],
				outputs: [{ type: "string", name: "" }],
			},
			{
				type: "function",
				name: "decimals",
				stateMutability: "view",
				inputs: [],
				outputs: [{ type: "uint8", name: "" }],
			},
			{
				type: "function",
				name: "balanceOf",
				stateMutability: "view",
				inputs: [{ type: "address", name: "account" }],
				outputs: [{ type: "uint256", name: "" }],
			},
			{
				type: "function",
				name: "transfer",
				stateMutability: "nonpayable",
				inputs: [
					{ type: "address", name: "to" },
					{ type: "uint256", name: "amount" },
				],
				outputs: [{ type: "bool", name: "" }],
			},
			{
				type: "function",
				name: "approve",
				stateMutability: "nonpayable",
				inputs: [
					{ type: "address", name: "spender" },
					{ type: "uint256", name: "amount" },
				],
				outputs: [{ type: "bool", name: "" }],
			},
		] as const;

		expect(erc20Abi).toHaveLength(6);
		expect(erc20Abi[0].name).toBe("name");
		expect(erc20Abi[4].name).toBe("transfer");
	});

	it("should work with Abi primitive", async () => {
		const Abi = await import("../../src/primitives/Abi/index.js");

		// Abi module should exist
		expect(Abi).toBeDefined();
	});

	it("should recognize transfer function selector", async () => {
		const { Keccak256 } = await import("../../src/crypto/index.js");
		const { Hex } = await import("../../src/primitives/Hex/index.js");

		// transfer(address,uint256) selector
		const signature = "transfer(address,uint256)";
		const hash = Keccak256.hash(new TextEncoder().encode(signature));
		const selector = Hex.fromBytes(hash.slice(0, 4));

		expect(selector).toBe("0xa9059cbb");
	});

	it("should recognize balanceOf function selector", async () => {
		const { Keccak256 } = await import("../../src/crypto/index.js");
		const { Hex } = await import("../../src/primitives/Hex/index.js");

		// balanceOf(address) selector
		const signature = "balanceOf(address)";
		const hash = Keccak256.hash(new TextEncoder().encode(signature));
		const selector = Hex.fromBytes(hash.slice(0, 4));

		expect(selector).toBe("0x70a08231");
	});

	it("should work with Address for contract addresses", async () => {
		const { Address } = await import("../../src/primitives/Address/index.js");

		// USDC contract address from guide
		const usdcAddress = Address("0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48");

		// toHex returns lowercase, toChecksumHex returns checksummed
		expect(Address.toHex(usdcAddress).toLowerCase()).toBe(
			"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",
		);
		expect(usdcAddress.length).toBe(20);
	});

	it("should work with Hex for calldata", async () => {
		const { Hex } = await import("../../src/primitives/Hex/index.js");

		// Example calldata
		const calldata = Hex.toBytes(
			"0xa9059cbb000000000000000000000000742d35cc6634c0532925a3b844bc454e4438f44e0000000000000000000000000000000000000000000000000000000000989680",
		);

		expect(calldata).toBeInstanceOf(Uint8Array);
		expect(calldata.length).toBe(68); // 4 bytes selector + 32 bytes address + 32 bytes amount
	});

	it("should work with Uniswap pair getReserves ABI structure", () => {
		// Multiple outputs from guide
		const pairAbi = [
			{
				type: "function",
				name: "getReserves",
				stateMutability: "view",
				inputs: [],
				outputs: [
					{ type: "uint112", name: "reserve0" },
					{ type: "uint112", name: "reserve1" },
					{ type: "uint32", name: "blockTimestampLast" },
				],
			},
		] as const;

		expect(pairAbi[0].outputs).toHaveLength(3);
		expect(pairAbi[0].outputs[0].type).toBe("uint112");
		expect(pairAbi[0].outputs[2].type).toBe("uint32");
	});

	it("should handle bigint return values", () => {
		// From guide: balance is bigint
		const balance = 1000000n; // 1 USDC (6 decimals)

		expect(typeof balance).toBe("bigint");
		expect(balance).toBe(1000000n);
	});

	it("should calculate token amount with decimals", () => {
		// 1 USDC = 1000000 (6 decimals)
		const decimals = 6;
		const oneToken = 1n * 10n ** BigInt(decimals);

		expect(oneToken).toBe(1_000_000n);
	});
});

```
