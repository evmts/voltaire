---
title: '[TS/JS] docs/getting-started/tree-shaking.test.ts'
source: 'docs/getting-started/tree-shaking.test.ts'
---

> Auto-generated from test file: docs/getting-started/tree-shaking.test.ts

```typescript
/**
 * Tests for code examples in tree-shaking.mdx
 *
 * This file tests the tree-shaking and data-first design examples.
 * Voltaire uses standalone functions that can be tree-shaken,
 * with a Class API wrapper for convenience.
 */
import { describe, expect, it } from "vitest";

describe("tree-shaking.mdx examples", () => {
	describe("Direct Function Imports", () => {
		it("imports standalone functions from Address module", async () => {
			// Tree-shakeable - only imports what you use
			const { fromHex, toHex, equals } = await import(
				"../../src/primitives/Address/internal-index.js"
			);

			const addr = fromHex("0x742d35Cc6634C0532925a3b844Bc9e7595f51e3e");
			const hex = toHex(addr);

			expect(hex).toBe("0x742d35cc6634c0532925a3b844bc9e7595f51e3e");
			expect(addr).toBeInstanceOf(Uint8Array);
			expect(addr.length).toBe(20);

			// equals function works
			const addr2 = fromHex("0x742d35Cc6634C0532925a3b844Bc9e7595f51e3e");
			expect(equals(addr, addr2)).toBe(true);
		});

		it("uses namespace API with Address constructor", async () => {
			// Namespace API - intuitive, consistent across all entrypoints
			const { Address } = await import("../../src/primitives/Address/index.js");

			const addr = Address("0x742d35Cc6634C0532925a3b844Bc9e7595f51e3e");
			const hex = Address.toHex(addr);

			expect(hex).toBe("0x742d35cc6634c0532925a3b844bc9e7595f51e3e");
		});
	});

	describe("Factory Pattern for Crypto Dependencies", () => {
		it("uses ToChecksummed factory with injected keccak256", async () => {
			// Tree-shakeable: bring your own keccak256
			const { ToChecksummed, fromHex } = await import(
				"../../src/primitives/Address/internal-index.js"
			);
			const { hash: keccak256 } = await import("../../src/crypto/Keccak256/hash.js");

			const toChecksummed = ToChecksummed({ keccak256 });
			const addr = fromHex("0x742d35cc6634c0532925a3b844bc9e7595f51e3e");
			const checksummed = toChecksummed(addr);

			// Checksummed address has mixed case based on EIP-55
			expect(checksummed).toMatch(/^0x[0-9a-fA-F]{40}$/);
			// API DISCREPANCY: Docs show "0x742d35Cc6634C0532925a3b844Bc9e7595f51e3e"
			// but actual implementation returns different casing based on keccak256 hash
			expect(checksummed).toBe("0x742d35CC6634c0532925a3B844bc9e7595f51E3e");
		});

		it("uses default toChecksummed export with auto-injected dependencies", async () => {
			// Convenient but includes keccak256 in bundle
			const { toChecksummed, fromHex } = await import(
				"../../src/primitives/Address/internal-index.js"
			);

			const addr = fromHex("0x742d35cc6634c0532925a3b844bc9e7595f51e3e");
			const checksummed = toChecksummed(addr);

			// API DISCREPANCY: Docs show different checksum, actual implementation is correct EIP-55
			expect(checksummed).toBe("0x742d35CC6634c0532925a3B844bc9e7595f51E3e");
		});
	});

	describe("How It Works: Tree-Shakable Methods -> Class API", () => {
		it("demonstrates toHex as standalone function", async () => {
			// The docs show the internal implementation pattern
			const { toHex, fromHex } = await import(
				"../../src/primitives/Address/internal-index.js"
			);

			const addr = fromHex("0x742d35Cc6634C0532925a3b844Bc9e7595f51e3e");
			const hex = toHex(addr);

			expect(hex).toBe("0x742d35cc6634c0532925a3b844bc9e7595f51e3e");
		});

		it("Class API wraps standalone functions", async () => {
			const { Address } = await import("../../src/primitives/Address/index.js");

			const addr = Address("0x742d35Cc6634C0532925a3b844Bc9e7595f51e3e");

			// Static method delegates to tree-shakable function
			const hexStatic = Address.toHex(addr);
			expect(hexStatic).toBe("0x742d35cc6634c0532925a3b844bc9e7595f51e3e");

			// Instance method delegates to same function
			const hexInstance = addr.toHex();
			expect(hexInstance).toBe("0x742d35cc6634c0532925a3b844bc9e7595f51e3e");

			// Both return the same result
			expect(hexStatic).toBe(hexInstance);
		});
	});
});

```
