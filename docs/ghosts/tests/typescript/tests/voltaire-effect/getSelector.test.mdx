---
title: getSelector Tests
description: Test examples for computing function, event, and error selectors from ABI items.
---

## Computes transfer selector correctly

Computes 4-byte function selector for ERC20 transfer.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as Effect from "effect/Effect"
import * as S from "effect/Schema"
import * as Abi from "voltaire-effect/primitives/Abi"

it.effect("computes transfer selector correctly", () =>
  Effect.gen(function* () {
    const fn = S.decodeUnknownSync(Abi.FunctionSchema)({
      type: "function",
      name: "transfer",
      stateMutability: "nonpayable",
      inputs: [
        { name: "to", type: "address" },
        { name: "amount", type: "uint256" },
      ],
      outputs: [],
    })
    const selector = yield* Abi.getSelector(fn)
    expect(selector).toBe("0xa9059cbb")
  }),
)
```

## Computes balanceOf selector correctly

Computes 4-byte function selector for ERC20 balanceOf.

```typescript
it.effect("computes balanceOf selector correctly", () =>
  Effect.gen(function* () {
    const fn = S.decodeUnknownSync(Abi.FunctionSchema)({
      type: "function",
      name: "balanceOf",
      stateMutability: "view",
      inputs: [{ name: "account", type: "address" }],
      outputs: [],
    })
    const selector = yield* Abi.getSelector(fn)
    expect(selector).toBe("0x70a08231")
  }),
)
```

## Function selector is 4 bytes

Verifies function selector length.

```typescript
it.effect("function selector is 4 bytes (10 hex chars with 0x)", () =>
  Effect.gen(function* () {
    const fn = S.decodeUnknownSync(Abi.FunctionSchema)({
      type: "function",
      name: "transfer",
      stateMutability: "nonpayable",
      inputs: [
        { name: "to", type: "address" },
        { name: "amount", type: "uint256" },
      ],
      outputs: [],
    })
    const selector = yield* Abi.getSelector(fn)
    expect(selector.length).toBe(10)
    expect(selector.startsWith("0x")).toBe(true)
  }),
)
```

## Computes Transfer event selector

Computes 32-byte topic hash for Transfer event.

```typescript
it.effect("computes Transfer event selector (32 bytes)", () =>
  Effect.gen(function* () {
    const evt = S.decodeUnknownSync(Abi.EventSchema)({
      type: "event",
      name: "Transfer",
      inputs: [
        { name: "from", type: "address", indexed: true },
        { name: "to", type: "address", indexed: true },
        { name: "value", type: "uint256", indexed: false },
      ],
    })
    const selector = yield* Abi.getSelector(evt)
    expect(selector.startsWith("0x")).toBe(true)
    expect(selector.length).toBe(66)
    expect(selector).toBe(
      "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef",
    )
  }),
)
```

## Computes error selector

Computes 4-byte selector for custom error.

```typescript
it.effect("computes error selector (4 bytes)", () =>
  Effect.gen(function* () {
    const err = S.decodeUnknownSync(Abi.ErrorSchema)({
      type: "error",
      name: "InsufficientBalance",
      inputs: [
        { name: "available", type: "uint256" },
        { name: "required", type: "uint256" },
      ],
    })
    const selector = yield* Abi.getSelector(err)
    expect(selector.startsWith("0x")).toBe(true)
    expect(selector.length).toBe(10)
  }),
)
```
