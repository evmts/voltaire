---
title: encodeFunctionData Tests
description: Test examples for encoding function call data with ABI and arguments.
---

## Encodes transfer function correctly

Encodes ERC20 transfer call with recipient address and amount.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as Effect from "effect/Effect"
import * as S from "effect/Schema"
import * as Abi from "voltaire-effect/primitives/Abi"

const erc20Abi = S.decodeUnknownSync(Abi.fromArray)([
  {
    type: "function",
    name: "transfer",
    stateMutability: "nonpayable",
    inputs: [
      { name: "to", type: "address" },
      { name: "amount", type: "uint256" },
    ],
    outputs: [{ type: "bool" }],
  },
])

it.effect("encodes transfer function correctly", () =>
  Effect.gen(function* () {
    const calldata = yield* Abi.encodeFunctionData(erc20Abi, "transfer", [
      "0x742d35Cc6634C0532925a3b844Bc9e7595f251e3",
      1000000000000000000n,
    ])
    expect(calldata.startsWith("0xa9059cbb")).toBe(true)
    expect(calldata.length).toBe(138)
  }),
)
```

## Encodes balanceOf function correctly

Encodes single-argument view function.

```typescript
it.effect("encodes balanceOf function correctly", () =>
  Effect.gen(function* () {
    const calldata = yield* Abi.encodeFunctionData(erc20Abi, "balanceOf", [
      "0x742d35Cc6634C0532925a3b844Bc9e7595f251e3",
    ])
    expect(calldata.startsWith("0x70a08231")).toBe(true)
    expect(calldata.length).toBe(74)
  }),
)
```

## Encodes with max uint256

Encodes function with maximum uint256 value.

```typescript
it.effect("encodes with max uint256", () =>
  Effect.gen(function* () {
    const maxUint256 = 2n ** 256n - 1n
    const calldata = yield* Abi.encodeFunctionData(erc20Abi, "transfer", [
      "0x742d35Cc6634C0532925a3b844Bc9e7595f251e3",
      maxUint256,
    ])
    expect(calldata).toContain("f".repeat(64))
  }),
)
```

## Fails with AbiItemNotFoundError for unknown function

Returns failure when function name doesn't exist in ABI.

```typescript
import * as Exit from "effect/Exit"

it("fails with AbiItemNotFoundError for unknown function", async () => {
  const exit = await Effect.runPromiseExit(
    Abi.encodeFunctionData(erc20Abi, "unknownFunction", []),
  )
  expect(Exit.isFailure(exit)).toBe(true)
})
```

## Fails with wrong argument types

Returns failure when arguments don't match function signature.

```typescript
it("fails with AbiEncodingError for wrong argument types", async () => {
  const exit = await Effect.runPromiseExit(
    Abi.encodeFunctionData(erc20Abi, "transfer", [
      "not an address",
      "not a uint",
    ]),
  )
  expect(Exit.isFailure(exit)).toBe(true)
})
```
