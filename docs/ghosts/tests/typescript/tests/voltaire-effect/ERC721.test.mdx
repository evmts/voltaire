---
title: ERC721 Tests
description: Test examples for ERC721 NFT standard showing encoding, decoding, and event parsing.
---

## SELECTORS Constants

Verifies the correct ERC721 function selectors.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as ERC721 from "voltaire-effect/standards/ERC721"

describe("ERC721", () => {
  describe("SELECTORS", () => {
    it("exports correct function selectors", () => {
      expect(ERC721.SELECTORS.balanceOf).toBe("0x70a08231")
      expect(ERC721.SELECTORS.ownerOf).toBe("0x6352211e")
      expect(ERC721.SELECTORS.transferFrom).toBe("0x23b872dd")
      expect(ERC721.SELECTORS.safeTransferFrom).toBe("0x42842e0e")
      expect(ERC721.SELECTORS.safeTransferFromWithData).toBe("0xb88d4fde")
      expect(ERC721.SELECTORS.approve).toBe("0x095ea7b3")
      expect(ERC721.SELECTORS.setApprovalForAll).toBe("0xa22cb465")
      expect(ERC721.SELECTORS.getApproved).toBe("0x081812fc")
      expect(ERC721.SELECTORS.isApprovedForAll).toBe("0xe985e9c5")
      expect(ERC721.SELECTORS.tokenURI).toBe("0xc87b56dd")
    })
  })
})
```

## EVENTS Constants

Verifies the correct ERC721 event topic signatures.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as ERC721 from "voltaire-effect/standards/ERC721"

describe("EVENTS", () => {
  it("exports correct event signatures", () => {
    expect(ERC721.EVENTS.Transfer).toBe(
      "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"
    )
    expect(ERC721.EVENTS.Approval).toBe(
      "0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925"
    )
    expect(ERC721.EVENTS.ApprovalForAll).toBe(
      "0x17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c31"
    )
  })
})
```

## encodeTransferFrom

Encodes transferFrom calldata for NFT transfers.

```typescript
import { describe, expect, it } from "@effect/vitest"
import { Address } from "voltaire-effect/primitives/Address"
import * as Effect from "effect/Effect"
import * as ERC721 from "voltaire-effect/standards/ERC721"

describe("encodeTransferFrom", () => {
  it("encodes transferFrom calldata", async () => {
    const testAddress = Address("0x1234567890123456789012345678901234567890")
    const testAddress2 = Address("0x0987654321098765432109876543210987654321")
    const result = await Effect.runPromise(
      ERC721.encodeTransferFrom(testAddress, testAddress2, 42n)
    )
    expect(result).toMatch(/^0x23b872dd/)
  })
})
```

## encodeSafeTransferFromWithData

Encodes safeTransferFrom calldata with additional data parameter.

```typescript
import { describe, expect, it } from "@effect/vitest"
import { Address } from "voltaire-effect/primitives/Address"
import * as Effect from "effect/Effect"
import * as ERC721 from "voltaire-effect/standards/ERC721"

describe("encodeSafeTransferFromWithData", () => {
  it("encodes safeTransferFrom calldata with data", async () => {
    const testAddress = Address("0x1234567890123456789012345678901234567890")
    const testAddress2 = Address("0x0987654321098765432109876543210987654321")
    const data = new Uint8Array([0xde, 0xad, 0xbe, 0xef])
    const result = await Effect.runPromise(
      ERC721.encodeSafeTransferFromWithData(testAddress, testAddress2, 42n, data)
    )
    expect(result).toMatch(/^0xb88d4fde/)
  })
})
```

## encodeBalanceOf

Encodes balanceOf calldata for querying NFT count.

```typescript
import { describe, expect, it } from "@effect/vitest"
import { Address } from "voltaire-effect/primitives/Address"
import * as Effect from "effect/Effect"
import * as ERC721 from "voltaire-effect/standards/ERC721"

describe("encodeBalanceOf", () => {
  it("encodes balanceOf calldata", async () => {
    const testAddress = Address("0x1234567890123456789012345678901234567890")
    const result = await Effect.runPromise(ERC721.encodeBalanceOf(testAddress))
    expect(result).toMatch(/^0x70a08231/)
  })

  it("encodes balanceOf calldata length", async () => {
    const testAddress = Address("0x1234567890123456789012345678901234567890")
    const result = await Effect.runPromise(ERC721.encodeBalanceOf(testAddress))
    expect(result.length).toBe(74)
  })
})
```

## decodeTransferEvent

Decodes Transfer event log data.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as Effect from "effect/Effect"
import * as ERC721 from "voltaire-effect/standards/ERC721"

describe("decodeTransferEvent", () => {
  it("decodes Transfer event log", async () => {
    const log = {
      topics: [
        ERC721.EVENTS.Transfer,
        "0x0000000000000000000000001234567890123456789012345678901234567890",
        "0x0000000000000000000000000987654321098765432109876543210987654321",
        "0x000000000000000000000000000000000000000000000000000000000000002a",
      ],
      data: "0x",
    }

    const result = await Effect.runPromise(ERC721.decodeTransferEvent(log))
    expect(result.from).toBe("0x1234567890123456789012345678901234567890")
    expect(result.to).toBe("0x0987654321098765432109876543210987654321")
    expect(result.tokenId).toBe(42n)
  })

  it("fails on invalid event signature", async () => {
    const log = {
      topics: ["0x1234", "0x0000", "0x0000", "0x0000"],
      data: "0x",
    }

    const result = await Effect.runPromiseExit(ERC721.decodeTransferEvent(log))
    expect(result._tag).toBe("Failure")
  })
})
```

## decodeBalanceOfResult

Decodes the balance value from balanceOf call.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as Effect from "effect/Effect"
import * as ERC721 from "voltaire-effect/standards/ERC721"

describe("decodeBalanceOfResult", () => {
  it("decodes balanceOf return value", async () => {
    const data = "0x000000000000000000000000000000000000000000000000000000000000002a"
    const result = await Effect.runPromise(ERC721.decodeBalanceOfResult(data))
    expect(result).toBe(42n)
  })

  it("decodes zero balance", async () => {
    const data = "0x0000000000000000000000000000000000000000000000000000000000000000"
    const result = await Effect.runPromise(ERC721.decodeBalanceOfResult(data))
    expect(result).toBe(0n)
  })
})
```

## decodeIsApprovedForAllResult

Decodes the approval status from isApprovedForAll call.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as Effect from "effect/Effect"
import * as ERC721 from "voltaire-effect/standards/ERC721"

describe("decodeIsApprovedForAllResult", () => {
  it("decodes approved=true", async () => {
    const data = "0x0000000000000000000000000000000000000000000000000000000000000001"
    const result = await Effect.runPromise(ERC721.decodeIsApprovedForAllResult(data))
    expect(result).toBe(true)
  })

  it("decodes approved=false", async () => {
    const data = "0x0000000000000000000000000000000000000000000000000000000000000000"
    const result = await Effect.runPromise(ERC721.decodeIsApprovedForAllResult(data))
    expect(result).toBe(false)
  })
})
```
