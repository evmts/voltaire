---
title: KZG Tests
description: Test examples for KZG polynomial commitments used in EIP-4844 blob transactions.
---

## KZGTest blobToKzgCommitment returns 48-byte commitment

Shows creating a KZG commitment from a blob.

```typescript
import { describe, expect, it } from "@effect/vitest";
import type { KzgBlobType } from "@tevm/voltaire";
import * as Effect from "effect/Effect";
import { KZGService, KZGTest } from "voltaire-effect/crypto/KZG";

it.effect("blobToKzgCommitment returns 48-byte commitment", () =>
  Effect.gen(function* () {
    const kzg = yield* KZGService;
    const result = yield* kzg.blobToKzgCommitment(
      new Uint8Array(131072) as KzgBlobType,
    );
    expect(result).toBeInstanceOf(Uint8Array);
    expect(result.length).toBe(48);
  }).pipe(Effect.provide(KZGTest)),
);
```

## KZGTest computeBlobKzgProof returns 48-byte proof

Demonstrates computing a proof for a blob commitment.

```typescript
import type { KzgBlobType, KzgCommitmentType } from "@tevm/voltaire";
import * as Effect from "effect/Effect";
import { KZGService, KZGTest } from "voltaire-effect/crypto/KZG";

it.effect("computeBlobKzgProof returns 48-byte proof", () =>
  Effect.gen(function* () {
    const kzg = yield* KZGService;
    const blob = new Uint8Array(131072) as KzgBlobType;
    const commitment = new Uint8Array(48) as KzgCommitmentType;
    const result = yield* kzg.computeBlobKzgProof(blob, commitment);
    expect(result).toBeInstanceOf(Uint8Array);
    expect(result.length).toBe(48);
  }).pipe(Effect.provide(KZGTest)),
);
```

## KZGTest verifyBlobKzgProof returns boolean

Shows verifying a blob proof against its commitment.

```typescript
import type { KzgBlobType, KzgCommitmentType, KzgProofType } from "@tevm/voltaire";
import * as Effect from "effect/Effect";
import { KZGService, KZGTest } from "voltaire-effect/crypto/KZG";

it.effect("verifyBlobKzgProof returns boolean", () =>
  Effect.gen(function* () {
    const kzg = yield* KZGService;
    const blob = new Uint8Array(131072) as KzgBlobType;
    const commitment = new Uint8Array(48) as KzgCommitmentType;
    const proof = new Uint8Array(48) as KzgProofType;
    const result = yield* kzg.verifyBlobKzgProof(blob, commitment, proof);
    expect(result).toBe(true);
  }).pipe(Effect.provide(KZGTest)),
);
```

## KZGTest isInitialized returns true

Verifies the KZG trusted setup is initialized.

```typescript
import * as Effect from "effect/Effect";
import { KZGService, KZGTest } from "voltaire-effect/crypto/KZG";

it.effect("isInitialized returns true", () =>
  Effect.gen(function* () {
    const kzg = yield* KZGService;
    const result = yield* kzg.isInitialized();
    expect(result).toBe(true);
  }).pipe(Effect.provide(KZGTest)),
);
```

## blobToKzgCommitment helper function

Shows the convenience function with service dependency.

```typescript
import type { KzgBlobType } from "@tevm/voltaire";
import * as Effect from "effect/Effect";
import { blobToKzgCommitment, KZGTest } from "voltaire-effect/crypto/KZG";

it.effect("commits blob with KZGService dependency", () =>
  Effect.gen(function* () {
    const blob = new Uint8Array(131072) as KzgBlobType;
    const result = yield* blobToKzgCommitment(blob);
    expect(result).toBeInstanceOf(Uint8Array);
    expect(result.length).toBe(48);
  }).pipe(Effect.provide(KZGTest)),
);
```

## computeBlobKzgProof helper function

Shows the convenience function for computing proofs.

```typescript
import type { KzgBlobType, KzgCommitmentType } from "@tevm/voltaire";
import * as Effect from "effect/Effect";
import { computeBlobKzgProof, KZGTest } from "voltaire-effect/crypto/KZG";

it.effect("computes proof with KZGService dependency", () =>
  Effect.gen(function* () {
    const blob = new Uint8Array(131072) as KzgBlobType;
    const commitment = new Uint8Array(48) as KzgCommitmentType;
    const result = yield* computeBlobKzgProof(blob, commitment);
    expect(result).toBeInstanceOf(Uint8Array);
    expect(result.length).toBe(48);
  }).pipe(Effect.provide(KZGTest)),
);
```

## verifyBlobKzgProof helper function

Shows the convenience function for verification.

```typescript
import type { KzgBlobType, KzgCommitmentType, KzgProofType } from "@tevm/voltaire";
import * as Effect from "effect/Effect";
import { verifyBlobKzgProof, KZGTest } from "voltaire-effect/crypto/KZG";

it.effect("verifies proof with KZGService dependency", () =>
  Effect.gen(function* () {
    const blob = new Uint8Array(131072) as KzgBlobType;
    const commitment = new Uint8Array(48) as KzgCommitmentType;
    const proof = new Uint8Array(48) as KzgProofType;
    const result = yield* verifyBlobKzgProof(blob, commitment, proof);
    expect(result).toBe(true);
  }).pipe(Effect.provide(KZGTest)),
);
```
