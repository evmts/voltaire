---
title: LogFilter Tests
description: Test examples for LogFilter schema showing RPC log filter validation with block range and blockhash constraints.
---

## Validates filter with block range

Demonstrates validating a log filter with fromBlock and toBlock.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as Schema from "effect/Schema"
import * as LogFilter from "voltaire-effect/primitives/LogFilter"

it("validates filter with block range", () => {
  const input = {
    fromBlock: 1000000n,
    toBlock: 1000100n,
  }
  const result = Schema.decodeSync(LogFilter.Rpc)(input)
  expect(result.fromBlock).toBe(1000000n)
  expect(result.toBlock).toBe(1000100n)
})
```

## Validates filter with block tags

Demonstrates using block tags like "latest" in filters.

```typescript
import * as Schema from "effect/Schema"
import * as LogFilter from "voltaire-effect/primitives/LogFilter"

it("validates filter with block tags", () => {
  const input = {
    fromBlock: "latest" as const,
  }
  const result = Schema.decodeSync(LogFilter.Rpc)(input)
  expect(result.fromBlock).toBe("latest")
})
```

## Validates filter with address

Demonstrates filtering logs by contract address.

```typescript
import * as Schema from "effect/Schema"
import * as LogFilter from "voltaire-effect/primitives/LogFilter"

it("validates filter with address", () => {
  const input = {
    address: "0x1234567890123456789012345678901234567890",
  }
  const result = Schema.decodeSync(LogFilter.Rpc)(input)
  expect(result.address).toBeInstanceOf(Uint8Array)
})
```

## Allows blockhash alone

Demonstrates filtering by blockhash instead of block range.

```typescript
import * as Schema from "effect/Schema"
import * as LogFilter from "voltaire-effect/primitives/LogFilter"

it("allows blockhash alone", () => {
  const input = {
    blockhash: `0x${"ab".repeat(32)}`,
  }
  const result = Schema.decodeSync(LogFilter.Rpc)(input)
  expect(result.blockhash).toBeInstanceOf(Uint8Array)
})
```

## Rejects blockhash with fromBlock/toBlock

Demonstrates mutual exclusivity of blockhash and block range.

```typescript
import * as Schema from "effect/Schema"
import * as LogFilter from "voltaire-effect/primitives/LogFilter"

it("rejects blockhash with fromBlock", () => {
  const input = {
    blockhash: `0x${"ab".repeat(32)}`,
    fromBlock: 1n,
  }
  expect(() => Schema.decodeSync(LogFilter.Rpc)(input)).toThrow(
    "blockhash is mutually exclusive with fromBlock/toBlock",
  )
})

it("rejects blockhash with toBlock", () => {
  const input = {
    blockhash: `0x${"ab".repeat(32)}`,
    toBlock: 100n,
  }
  expect(() => Schema.decodeSync(LogFilter.Rpc)(input)).toThrow(
    "blockhash is mutually exclusive with fromBlock/toBlock",
  )
})

it("rejects blockhash with both fromBlock and toBlock", () => {
  const input = {
    blockhash: `0x${"ab".repeat(32)}`,
    fromBlock: 1n,
    toBlock: 100n,
  }
  expect(() => Schema.decodeSync(LogFilter.Rpc)(input)).toThrow(
    "blockhash is mutually exclusive with fromBlock/toBlock",
  )
})
```
