---
title: writeContract Tests
description: Test examples for writeContract showing ABI-encoded contract function calls and transaction sending.
---

## Encodes function call and sends transaction

Demonstrates calling a contract function with ABI encoding and sending the transaction.

```typescript
import { Effect } from 'effect'
import * as S from 'effect/Schema'
import * as Hash from '@tevm/voltaire/Hash'
import { writeContract } from 'voltaire-effect'
import { Signer } from 'voltaire-effect'
import * as AbiSchema from 'voltaire-effect/primitives/Abi'

const erc20Abi = S.decodeUnknownSync(AbiSchema.fromArray)([
  {
    type: "function",
    name: "transfer",
    inputs: [
      { name: "to", type: "address" },
      { name: "amount", type: "uint256" },
    ],
    outputs: [{ type: "bool" }],
    stateMutability: "nonpayable",
  },
])

const program = writeContract({
  address: "0xabababababababababababababababababababab",
  abi: erc20Abi,
  functionName: "transfer",
  args: ["0x1234567890123456789012345678901234567890", 1000000000000000000n],
})

const result = await Effect.runPromise(
  Effect.provide(program, TestSignerLayer),
)

expect(Hash.equals(result, mockTxHash)).toBe(true)
```

## Sends transaction with value

Shows sending ETH value along with a contract call.

```typescript
import { Effect } from 'effect'
import { writeContract } from 'voltaire-effect'

const program = writeContract({
  address: "0xabababababababababababababababababababab",
  abi: erc20Abi,
  functionName: "transfer",
  args: [recipient, 1000000000000000000n],
  value: 5000000000000000000n,
})

await Effect.runPromise(Effect.provide(program, TestSignerLayer))
```

## Sends transaction with custom gas params

Demonstrates specifying custom gas limit and EIP-1559 fee parameters.

```typescript
import { Effect } from 'effect'
import { writeContract } from 'voltaire-effect'

const program = writeContract({
  address: "0xabababababababababababababababababababab",
  abi: erc20Abi,
  functionName: "approve",
  args: ["0x1234567890123456789012345678901234567890", 100n],
  gas: 50000n,
  maxFeePerGas: 30000000000n,
  maxPriorityFeePerGas: 2000000000n,
})

await Effect.runPromise(Effect.provide(program, TestSignerLayer))
```

## Works with legacy gas price

Shows using legacy gasPrice instead of EIP-1559 fee parameters.

```typescript
import { Effect } from 'effect'
import { writeContract } from 'voltaire-effect'

const program = writeContract({
  address: "0xabababababababababababababababababababab",
  abi: erc20Abi,
  functionName: "transfer",
  args: ["0x1234567890123456789012345678901234567890", 100n],
  gasPrice: 25000000000n,
})

await Effect.runPromise(Effect.provide(program, TestSignerLayer))
```

## Accepts branded address type

Demonstrates that branded AddressType works as contract address.

```typescript
import { Effect } from 'effect'
import { writeContract } from 'voltaire-effect'
import type { BrandedAddress } from '@tevm/voltaire'

type AddressType = BrandedAddress.AddressType
const mockAddress = new Uint8Array(20).fill(0xab) as AddressType

const program = writeContract({
  address: mockAddress,
  abi: erc20Abi,
  functionName: "transfer",
  args: ["0x1234567890123456789012345678901234567890", 1000000000000000000n],
})

const result = await Effect.runPromise(
  Effect.provide(program, TestSignerLayer),
)
```
