---
title: decodeFunctionResult Tests
description: Test examples for decoding function return values from ABI-encoded hex.
---

## Round-trips balanceOf result

Encodes then decodes uint256 return value.

```typescript
import { describe, expect, it } from "@effect/vitest"
import { Hex } from "voltaire"
import * as Effect from "effect/Effect"
import * as S from "effect/Schema"
import * as Abi from "voltaire-effect/primitives/Abi"

const erc20Abi = S.decodeUnknownSync(Abi.fromArray)([
  {
    type: "function",
    name: "balanceOf",
    stateMutability: "view",
    inputs: [{ name: "account", type: "address" }],
    outputs: [{ type: "uint256" }],
  },
  {
    type: "function",
    name: "transfer",
    stateMutability: "nonpayable",
    inputs: [
      { name: "to", type: "address" },
      { name: "amount", type: "uint256" },
    ],
    outputs: [{ type: "bool" }],
  },
])

it.effect("round-trips balanceOf result", () =>
  Effect.gen(function* () {
    const balance = 1000000000000000000n
    const encoded = yield* Abi.encodeFunctionResult(erc20Abi, "balanceOf", [
      balance,
    ])
    const decoded = yield* Abi.decodeFunctionResult(
      erc20Abi,
      "balanceOf",
      encoded,
    )
    expect(decoded[0]).toBe(balance)
  }),
)
```

## Round-trips transfer bool result

Encodes then decodes boolean return value.

```typescript
it.effect("round-trips transfer bool result (true)", () =>
  Effect.gen(function* () {
    const encoded = yield* Abi.encodeFunctionResult(erc20Abi, "transfer", [
      true,
    ])
    const decoded = yield* Abi.decodeFunctionResult(
      erc20Abi,
      "transfer",
      encoded,
    )
    expect(decoded[0]).toBe(true)
  }),
)
```

## Decodes known uint256 hex

Decodes raw hex-encoded uint256 value.

```typescript
it.effect("decodes known uint256 hex", () =>
  Effect.gen(function* () {
    const data = Hex(
      "0x0000000000000000000000000000000000000000000000000de0b6b3a7640000",
    )
    const decoded = yield* Abi.decodeFunctionResult(
      erc20Abi,
      "balanceOf",
      data,
    )
    expect(decoded[0]).toBe(1000000000000000000n)
  }),
)
```

## Decodes true bool hex

Decodes raw hex-encoded true value.

```typescript
it.effect("decodes true bool hex", () =>
  Effect.gen(function* () {
    const data = Hex(
      "0x0000000000000000000000000000000000000000000000000000000000000001",
    )
    const decoded = yield* Abi.decodeFunctionResult(erc20Abi, "transfer", data)
    expect(decoded[0]).toBe(true)
  }),
)
```

## Fails for unknown function

Returns failure when function name doesn't exist in ABI.

```typescript
import * as Exit from "effect/Exit"

it("fails for unknown function", async () => {
  const exit = await Effect.runPromiseExit(
    Abi.decodeFunctionResult(
      erc20Abi,
      "unknownFunction",
      Hex("0x0000000000000000000000000000000000000000000000000000000000000000"),
    ),
  )
  expect(Exit.isFailure(exit)).toBe(true)
})
```
