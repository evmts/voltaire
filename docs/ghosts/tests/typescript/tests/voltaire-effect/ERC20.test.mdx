---
title: ERC20 Tests
description: Test examples for ERC20 token standard showing encoding, decoding, and event parsing.
---

## SELECTORS Constants

Verifies the correct ERC20 function selectors.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as ERC20 from "voltaire-effect/standards/ERC20"

describe("ERC20", () => {
  describe("SELECTORS", () => {
    it("exports correct function selectors", () => {
      expect(ERC20.SELECTORS.transfer).toBe("0xa9059cbb")
      expect(ERC20.SELECTORS.approve).toBe("0x095ea7b3")
      expect(ERC20.SELECTORS.balanceOf).toBe("0x70a08231")
      expect(ERC20.SELECTORS.transferFrom).toBe("0x23b872dd")
      expect(ERC20.SELECTORS.allowance).toBe("0xdd62ed3e")
    })
  })
})
```

## EVENTS Constants

Verifies the correct ERC20 event topic signatures.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as ERC20 from "voltaire-effect/standards/ERC20"

describe("EVENTS", () => {
  it("exports correct event signatures", () => {
    expect(ERC20.EVENTS.Transfer).toBe(
      "0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"
    )
    expect(ERC20.EVENTS.Approval).toBe(
      "0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925"
    )
  })
})
```

## encodeTransfer

Encodes transfer calldata for token transfers.

```typescript
import { describe, expect, it } from "@effect/vitest"
import { Address } from "voltaire-effect/primitives/Address"
import * as Effect from "effect/Effect"
import * as ERC20 from "voltaire-effect/standards/ERC20"

describe("encodeTransfer", () => {
  it("encodes transfer calldata", async () => {
    const testAddress = Address("0x1234567890123456789012345678901234567890")
    const testAmount = 1000000000000000000n
    const result = await Effect.runPromise(
      ERC20.encodeTransfer(testAddress, testAmount)
    )
    expect(result).toMatch(/^0xa9059cbb/)
  })
})
```

## encodeApprove

Encodes approve calldata for token approvals.

```typescript
import { describe, expect, it } from "@effect/vitest"
import { Address } from "voltaire-effect/primitives/Address"
import * as Effect from "effect/Effect"
import * as ERC20 from "voltaire-effect/standards/ERC20"

describe("encodeApprove", () => {
  it("encodes approve calldata", async () => {
    const testAddress = Address("0x1234567890123456789012345678901234567890")
    const testAmount = 1000000000000000000n
    const result = await Effect.runPromise(
      ERC20.encodeApprove(testAddress, testAmount)
    )
    expect(result).toMatch(/^0x095ea7b3/)
  })
})
```

## encodeName, encodeSymbol, encodeDecimals

Encodes metadata query calldata.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as Effect from "effect/Effect"
import * as ERC20 from "voltaire-effect/standards/ERC20"

describe("metadata encoders", () => {
  it("encodes name calldata", async () => {
    const result = await Effect.runPromise(ERC20.encodeName())
    expect(result).toBe("0x06fdde03")
  })

  it("encodes symbol calldata", async () => {
    const result = await Effect.runPromise(ERC20.encodeSymbol())
    expect(result).toBe("0x95d89b41")
  })

  it("encodes decimals calldata", async () => {
    const result = await Effect.runPromise(ERC20.encodeDecimals())
    expect(result).toBe("0x313ce567")
  })

  it("encodes totalSupply calldata", async () => {
    const result = await Effect.runPromise(ERC20.encodeTotalSupply())
    expect(result).toBe("0x18160ddd")
  })
})
```

## decodeTransferEvent

Decodes Transfer event log data.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as Effect from "effect/Effect"
import * as ERC20 from "voltaire-effect/standards/ERC20"

describe("decodeTransferEvent", () => {
  it("decodes Transfer event log", async () => {
    const log = {
      topics: [
        ERC20.EVENTS.Transfer,
        "0x0000000000000000000000001234567890123456789012345678901234567890",
        "0x0000000000000000000000000987654321098765432109876543210987654321",
      ],
      data: "0x0000000000000000000000000000000000000000000000000de0b6b3a7640000",
    }

    const result = await Effect.runPromise(ERC20.decodeTransferEvent(log))
    expect(result.from).toBe("0x1234567890123456789012345678901234567890")
    expect(result.to).toBe("0x0987654321098765432109876543210987654321")
    expect(result.value).toBe(1000000000000000000n)
  })

  it("fails on invalid event signature", async () => {
    const log = {
      topics: ["0x1234", "0x0000", "0x0000"],
      data: "0x0000",
    }

    const result = await Effect.runPromiseExit(ERC20.decodeTransferEvent(log))
    expect(result._tag).toBe("Failure")
  })
})
```

## decodeDecimalsResult

Decodes the decimals value from decimals call.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as Effect from "effect/Effect"
import * as ERC20 from "voltaire-effect/standards/ERC20"

describe("decodeDecimalsResult", () => {
  it("decodes 18 decimals (standard)", async () => {
    const data = "0x0000000000000000000000000000000000000000000000000000000000000012"
    const result = await Effect.runPromise(ERC20.decodeDecimalsResult(data))
    expect(result).toBe(18)
  })

  it("decodes 6 decimals (USDC)", async () => {
    const data = "0x0000000000000000000000000000000000000000000000000000000000000006"
    const result = await Effect.runPromise(ERC20.decodeDecimalsResult(data))
    expect(result).toBe(6)
  })

  it("decodes 8 decimals (WBTC)", async () => {
    const data = "0x0000000000000000000000000000000000000000000000000000000000000008"
    const result = await Effect.runPromise(ERC20.decodeDecimalsResult(data))
    expect(result).toBe(8)
  })
})
```

## decodeNameResult

Decodes the name string from name call.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as Effect from "effect/Effect"
import * as ERC20 from "voltaire-effect/standards/ERC20"

describe("decodeNameResult", () => {
  it("decodes string name", async () => {
    const data =
      "0x0000000000000000000000000000000000000000000000000000000000000020" +
      "000000000000000000000000000000000000000000000000000000000000000a" +
      "5465737420546f6b656e00000000000000000000000000000000000000000000"
    const result = await Effect.runPromise(ERC20.decodeNameResult(data))
    expect(result).toBe("Test Token")
  })

  it("decodes Tether USD", async () => {
    const data =
      "0x0000000000000000000000000000000000000000000000000000000000000020" +
      "000000000000000000000000000000000000000000000000000000000000000a" +
      "5465746865722055534400000000000000000000000000000000000000000000"
    const result = await Effect.runPromise(ERC20.decodeNameResult(data))
    expect(result).toBe("Tether USD")
  })
})
```
