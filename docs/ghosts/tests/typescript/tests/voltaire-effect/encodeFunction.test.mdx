---
title: encodeFunction Tests
description: Test examples for encoding complete function call data with ABI.
---

## Encodes transfer function

Encodes ERC20 transfer call with recipient and amount.

```typescript
import { describe, expect, it } from "@effect/vitest"
import * as Effect from "effect/Effect"
import * as S from "effect/Schema"
import * as Abi from "voltaire-effect/primitives/Abi"

const erc20Abi = S.decodeUnknownSync(Abi.fromArray)([
  {
    type: "function",
    name: "transfer",
    stateMutability: "nonpayable",
    inputs: [
      { name: "to", type: "address" },
      { name: "amount", type: "uint256" },
    ],
    outputs: [{ type: "bool" }],
  },
  {
    type: "function",
    name: "balanceOf",
    stateMutability: "view",
    inputs: [{ name: "account", type: "address" }],
    outputs: [{ type: "uint256" }],
  },
])

it.effect("encodes transfer function", () =>
  Effect.gen(function* () {
    const calldata = yield* Abi.encodeFunction(erc20Abi, "transfer", [
      "0x742d35Cc6634C0532925a3b844Bc9e7595f251e3",
      1000000000000000000n,
    ])
    expect(calldata.startsWith("0xa9059cbb")).toBe(true)
  }),
)
```

## Encodes balanceOf function

Encodes single-argument view function call.

```typescript
it.effect("encodes balanceOf function", () =>
  Effect.gen(function* () {
    const calldata = yield* Abi.encodeFunction(erc20Abi, "balanceOf", [
      "0x742d35Cc6634C0532925a3b844Bc9e7595f251e3",
    ])
    expect(calldata.startsWith("0x70a08231")).toBe(true)
  }),
)
```

## Fails for unknown function

Returns failure when function name doesn't exist in ABI.

```typescript
import * as Exit from "effect/Exit"

it("fails for unknown function", async () => {
  const exit = await Effect.runPromiseExit(
    Abi.encodeFunction(erc20Abi, "unknownFunction", []),
  )
  expect(Exit.isFailure(exit)).toBe(true)
})
```

## Fails with empty ABI

Returns failure when ABI has no items.

```typescript
it("fails with empty ABI", async () => {
  const exit = await Effect.runPromiseExit(
    Abi.encodeFunction([], "transfer", ["0x123", 100n]),
  )
  expect(Exit.isFailure(exit)).toBe(true)
})
```
