---
title: '[TS/JS] voltaire-effect/src/primitives/Abi/encodeEventLog.test.ts'
source: 'voltaire-effect/src/primitives/Abi/encodeEventLog.test.ts'
---

> Auto-generated from test file: voltaire-effect/src/primitives/Abi/encodeEventLog.test.ts

```typescript
import { describe, expect, it } from "@effect/vitest";
import * as Effect from "effect/Effect";
import * as Exit from "effect/Exit";
import * as S from "effect/Schema";
import { fromArray } from "./AbiSchema.js";
import { encodeEventLog } from "./encodeEventLog.js";

const erc20Abi = S.decodeUnknownSync(fromArray)([
	{
		type: "event",
		name: "Transfer",
		inputs: [
			{ name: "from", type: "address", indexed: true },
			{ name: "to", type: "address", indexed: true },
			{ name: "value", type: "uint256", indexed: false },
		],
	},
	{
		type: "event",
		name: "Approval",
		inputs: [
			{ name: "owner", type: "address", indexed: true },
			{ name: "spender", type: "address", indexed: true },
			{ name: "value", type: "uint256", indexed: false },
		],
	},
]);

describe("encodeEventLog", () => {
	describe("success cases", () => {
		it.effect("encodes Transfer event topics", () =>
			Effect.gen(function* () {
				const topics = yield* encodeEventLog(erc20Abi, "Transfer", [
					"0x742d35Cc6634C0532925a3b844Bc9e7595f251e3",
					"0x1234567890123456789012345678901234567890",
				]);
				expect(topics.length).toBeGreaterThanOrEqual(1);
				const topic0 = topics[0];
				expect(topic0).not.toBeNull();
				if (topic0) {
					expect(topic0.startsWith("0x")).toBe(true);
				}
			}),
		);

		it.effect("encodes Approval event topics", () =>
			Effect.gen(function* () {
				const topics = yield* encodeEventLog(erc20Abi, "Approval", [
					"0x742d35Cc6634C0532925a3b844Bc9e7595f251e3",
					"0x1234567890123456789012345678901234567890",
				]);
				expect(topics.length).toBeGreaterThanOrEqual(1);
				const topic0 = topics[0];
				expect(topic0).not.toBeNull();
				if (topic0) {
					expect(topic0.startsWith("0x")).toBe(true);
				}
			}),
		);

		it.effect("returns 32-byte topic0 for event signature", () =>
			Effect.gen(function* () {
				const topics = yield* encodeEventLog(erc20Abi, "Transfer", [
					"0x742d35Cc6634C0532925a3b844Bc9e7595f251e3",
					"0x1234567890123456789012345678901234567890",
				]);
				const topic0 = topics[0];
				expect(topic0).not.toBeNull();
				if (topic0) {
					expect(topic0.length).toBe(66);
				}
			}),
		);
	});

	describe("error cases", () => {
		it("fails for unknown event", async () => {
			const exit = await Effect.runPromiseExit(
				encodeEventLog(erc20Abi, "UnknownEvent", []),
			);
			expect(Exit.isFailure(exit)).toBe(true);
		});

		it("fails with empty ABI", async () => {
			const exit = await Effect.runPromiseExit(
				encodeEventLog([], "Transfer", []),
			);
			expect(Exit.isFailure(exit)).toBe(true);
		});
	});
});

```
