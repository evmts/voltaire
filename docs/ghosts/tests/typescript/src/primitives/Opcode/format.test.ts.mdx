---
title: '[TS/JS] src/primitives/Opcode/format.test.ts'
source: 'src/primitives/Opcode/format.test.ts'
---

> Auto-generated from test file: src/primitives/Opcode/format.test.ts

```typescript
/**
 * Tests for Opcode.format
 */

import { describe, expect, it } from "vitest";
import { format } from "./format.js";
import * as Opcode from "./Opcode.js";
import type { Instruction } from "./OpcodeType.js";

describe("Opcode.format", () => {
	it("formats simple instruction without immediate", () => {
		const inst: Instruction = {
			offset: 0,
			opcode: Opcode.ADD,
			immediate: undefined,
		};
		const result = format(inst);
		expect(result).toBe("0x0000: ADD");
	});

	it("formats instruction with offset", () => {
		const inst: Instruction = {
			offset: 42,
			opcode: Opcode.MUL,
			immediate: undefined,
		};
		const result = format(inst);
		expect(result).toBe("0x002a: MUL");
	});

	it("formats instruction with large offset", () => {
		const inst: Instruction = {
			offset: 0x1234,
			opcode: Opcode.SUB,
			immediate: undefined,
		};
		const result = format(inst);
		expect(result).toBe("0x1234: SUB");
	});

	it("formats PUSH1 with immediate", () => {
		const inst: Instruction = {
			offset: 0,
			opcode: Opcode.PUSH1,
			immediate: new Uint8Array([0x42]),
		};
		const result = format(inst);
		expect(result).toBe("0x0000: PUSH1 0x42");
	});

	it("formats PUSH2 with immediate", () => {
		const inst: Instruction = {
			offset: 10,
			opcode: Opcode.PUSH2,
			immediate: new Uint8Array([0x12, 0x34]),
		};
		const result = format(inst);
		expect(result).toBe("0x000a: PUSH2 0x1234");
	});

	it("formats PUSH32 with full immediate", () => {
		const inst: Instruction = {
			offset: 0,
			opcode: Opcode.PUSH32,
			immediate: new Uint8Array(Array(32).fill(0xff)),
		};
		const result = format(inst);
		expect(result).toBe(`0x0000: PUSH32 0x${"ff".repeat(32)}`);
	});

	it("formats PUSH with zero immediate", () => {
		const inst: Instruction = {
			offset: 0,
			opcode: Opcode.PUSH1,
			immediate: new Uint8Array([0x00]),
		};
		const result = format(inst);
		expect(result).toBe("0x0000: PUSH1 0x00");
	});

	it("formats instruction with empty immediate", () => {
		const inst: Instruction = {
			offset: 0,
			opcode: Opcode.ADD,
			immediate: new Uint8Array([]),
		};
		const result = format(inst);
		expect(result).toBe("0x0000: ADD");
	});

	it("pads offset with leading zeros", () => {
		const inst: Instruction = {
			offset: 5,
			opcode: Opcode.STOP,
			immediate: undefined,
		};
		const result = format(inst);
		expect(result).toBe("0x0005: STOP");
	});

	it("pads immediate bytes with leading zeros", () => {
		const inst: Instruction = {
			offset: 0,
			opcode: Opcode.PUSH2,
			immediate: new Uint8Array([0x00, 0x01]),
		};
		const result = format(inst);
		expect(result).toBe("0x0000: PUSH2 0x0001");
	});

	it("formats DUP instructions", () => {
		const inst: Instruction = {
			offset: 0,
			opcode: Opcode.DUP1,
			immediate: undefined,
		};
		const result = format(inst);
		expect(result).toBe("0x0000: DUP1");
	});

	it("formats SWAP instructions", () => {
		const inst: Instruction = {
			offset: 0,
			opcode: Opcode.SWAP1,
			immediate: undefined,
		};
		const result = format(inst);
		expect(result).toBe("0x0000: SWAP1");
	});

	it("formats LOG instructions", () => {
		const inst: Instruction = {
			offset: 0,
			opcode: Opcode.LOG0,
			immediate: undefined,
		};
		const result = format(inst);
		expect(result).toBe("0x0000: LOG0");
	});

	it("formats JUMPDEST", () => {
		const inst: Instruction = {
			offset: 100,
			opcode: Opcode.JUMPDEST,
			immediate: undefined,
		};
		const result = format(inst);
		expect(result).toBe("0x0064: JUMPDEST");
	});

	it("formats REVERT", () => {
		const inst: Instruction = {
			offset: 0,
			opcode: Opcode.REVERT,
			immediate: undefined,
		};
		const result = format(inst);
		expect(result).toBe("0x0000: REVERT");
	});

	it("formats SELFDESTRUCT", () => {
		const inst: Instruction = {
			offset: 0,
			opcode: Opcode.SELFDESTRUCT,
			immediate: undefined,
		};
		const result = format(inst);
		expect(result).toBe("0x0000: SELFDESTRUCT");
	});
});

```
