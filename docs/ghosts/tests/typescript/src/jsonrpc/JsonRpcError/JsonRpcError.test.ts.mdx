---
title: '[TS/JS] src/jsonrpc/JsonRpcError/JsonRpcError.test.ts'
source: 'src/jsonrpc/JsonRpcError/JsonRpcError.test.ts'
---

> Auto-generated from test file: src/jsonrpc/JsonRpcError/JsonRpcError.test.ts

```typescript
import { describe, expect, it } from "vitest";
import {
	from,
	INTERNAL_ERROR,
	INVALID_INPUT,
	INVALID_PARAMS,
	INVALID_REQUEST,
	JSON_RPC_VERSION_NOT_SUPPORTED,
	JsonRpcError,
	LIMIT_EXCEEDED,
	METHOD_NOT_FOUND,
	METHOD_NOT_SUPPORTED,
	PARSE_ERROR,
	RESOURCE_NOT_FOUND,
	RESOURCE_UNAVAILABLE,
	TRANSACTION_REJECTED,
	// biome-ignore lint/suspicious/noShadowRestrictedNames: Test imports intentionally shadow toString for testing
	toString,
} from "./index.js";

describe("JsonRpcError", () => {
	describe("from", () => {
		it("creates error from code and message", () => {
			const err = from(-32601, "Method not found");
			expect(err).toEqual({
				code: -32601,
				message: "Method not found",
			});
		});

		it("creates error with data", () => {
			const err = from(-32602, "Invalid params", { expected: "number" });
			expect(err).toEqual({
				code: -32602,
				message: "Invalid params",
				data: { expected: "number" },
			});
		});

		it("creates error from object", () => {
			const err = from({
				code: -32700,
				message: "Parse error",
			});
			expect(err).toEqual({
				code: -32700,
				message: "Parse error",
			});
		});

		it("creates error from object with data", () => {
			const err = from({
				code: -32600,
				message: "Invalid Request",
				data: { reason: "missing method" },
			});
			expect(err).toEqual({
				code: -32600,
				message: "Invalid Request",
				data: { reason: "missing method" },
			});
		});

		it("throws on invalid code type", () => {
			// @ts-expect-error - Testing invalid input
			expect(() => from("invalid", "message")).toThrow(TypeError);
		});

		it("throws on invalid message type", () => {
			// @ts-expect-error - Testing invalid input
			expect(() => from(-32601, 123)).toThrow(TypeError);
		});

		it("throws on invalid error object", () => {
			// @ts-expect-error - Testing invalid input
			expect(() => from({ code: "invalid", message: "test" })).toThrow(
				TypeError,
			);
			// @ts-expect-error - Testing invalid input
			expect(() => from({ code: -32601, message: 123 })).toThrow(TypeError);
		});
	});

	describe("toString", () => {
		it("formats error message", () => {
			const err = from(-32601, "Method not found");
			expect(toString(err)).toBe("[-32601] Method not found");
		});

		it("formats error with data", () => {
			const err = from(-32602, "Invalid params", { test: true });
			expect(toString(err)).toBe("[-32602] Invalid params");
		});
	});

	describe("constants", () => {
		it("exports standard JSON-RPC 2.0 error codes", () => {
			expect(PARSE_ERROR).toBe(-32700);
			expect(INVALID_REQUEST).toBe(-32600);
			expect(METHOD_NOT_FOUND).toBe(-32601);
			expect(INVALID_PARAMS).toBe(-32602);
			expect(INTERNAL_ERROR).toBe(-32603);
		});

		it("exports Ethereum-specific error codes (EIP-1474)", () => {
			expect(INVALID_INPUT).toBe(-32000);
			expect(RESOURCE_NOT_FOUND).toBe(-32001);
			expect(RESOURCE_UNAVAILABLE).toBe(-32002);
			expect(TRANSACTION_REJECTED).toBe(-32003);
			expect(METHOD_NOT_SUPPORTED).toBe(-32004);
			expect(LIMIT_EXCEEDED).toBe(-32005);
			expect(JSON_RPC_VERSION_NOT_SUPPORTED).toBe(-32006);
		});

		it("namespace has all error codes", () => {
			// Standard JSON-RPC 2.0
			expect(JsonRpcError.PARSE_ERROR).toBe(-32700);
			expect(JsonRpcError.INVALID_REQUEST).toBe(-32600);
			expect(JsonRpcError.METHOD_NOT_FOUND).toBe(-32601);
			expect(JsonRpcError.INVALID_PARAMS).toBe(-32602);
			expect(JsonRpcError.INTERNAL_ERROR).toBe(-32603);
			// Ethereum-specific (EIP-1474)
			expect(JsonRpcError.INVALID_INPUT).toBe(-32000);
			expect(JsonRpcError.RESOURCE_NOT_FOUND).toBe(-32001);
			expect(JsonRpcError.RESOURCE_UNAVAILABLE).toBe(-32002);
			expect(JsonRpcError.TRANSACTION_REJECTED).toBe(-32003);
			expect(JsonRpcError.METHOD_NOT_SUPPORTED).toBe(-32004);
			expect(JsonRpcError.LIMIT_EXCEEDED).toBe(-32005);
			expect(JsonRpcError.JSON_RPC_VERSION_NOT_SUPPORTED).toBe(-32006);
		});
	});

	describe("namespace", () => {
		it("JsonRpcError.from() works", () => {
			const err = JsonRpcError.from(-32601, "Method not found");
			expect(err).toEqual({
				code: -32601,
				message: "Method not found",
			});
		});

		it("JsonRpcError.toString() works", () => {
			const err = JsonRpcError.from(-32601, "Method not found");
			expect(JsonRpcError.toString(err)).toBe("[-32601] Method not found");
		});
	});

	describe("standard JSON-RPC 2.0 errors", () => {
		it("creates parse error", () => {
			const err = from(PARSE_ERROR, "Parse error");
			expect(err.code).toBe(-32700);
			expect(err.message).toBe("Parse error");
		});

		it("creates invalid request error", () => {
			const err = from(INVALID_REQUEST, "Invalid Request");
			expect(err.code).toBe(-32600);
			expect(err.message).toBe("Invalid Request");
		});

		it("creates method not found error", () => {
			const err = from(METHOD_NOT_FOUND, "Method not found");
			expect(err.code).toBe(-32601);
			expect(err.message).toBe("Method not found");
		});

		it("creates invalid params error", () => {
			const err = from(INVALID_PARAMS, "Invalid params");
			expect(err.code).toBe(-32602);
			expect(err.message).toBe("Invalid params");
		});

		it("creates internal error", () => {
			const err = from(INTERNAL_ERROR, "Internal error");
			expect(err.code).toBe(-32603);
			expect(err.message).toBe("Internal error");
		});
	});

	describe("Ethereum-specific errors (EIP-1474)", () => {
		it("creates invalid input error (execution reverted)", () => {
			const err = from(
				INVALID_INPUT,
				"execution reverted",
				"0x08c379a00000000000000000000000000000000000000000000000000000000000000020",
			);
			expect(err.code).toBe(-32000);
			expect(err.message).toBe("execution reverted");
			expect(err.data).toBe(
				"0x08c379a00000000000000000000000000000000000000000000000000000000000000020",
			);
		});

		it("creates resource not found error", () => {
			const err = from(RESOURCE_NOT_FOUND, "Block not found");
			expect(err.code).toBe(-32001);
			expect(err.message).toBe("Block not found");
		});

		it("creates resource unavailable error", () => {
			const err = from(RESOURCE_UNAVAILABLE, "Node is syncing");
			expect(err.code).toBe(-32002);
			expect(err.message).toBe("Node is syncing");
		});

		it("creates transaction rejected error", () => {
			const err = from(TRANSACTION_REJECTED, "Insufficient funds");
			expect(err.code).toBe(-32003);
			expect(err.message).toBe("Insufficient funds");
		});

		it("creates method not supported error", () => {
			const err = from(METHOD_NOT_SUPPORTED, "Method not implemented");
			expect(err.code).toBe(-32004);
			expect(err.message).toBe("Method not implemented");
		});

		it("creates limit exceeded error", () => {
			const err = from(LIMIT_EXCEEDED, "Rate limit exceeded");
			expect(err.code).toBe(-32005);
			expect(err.message).toBe("Rate limit exceeded");
		});

		it("creates JSON-RPC version not supported error", () => {
			const err = from(
				JSON_RPC_VERSION_NOT_SUPPORTED,
				"Only JSON-RPC 2.0 is supported",
			);
			expect(err.code).toBe(-32006);
			expect(err.message).toBe("Only JSON-RPC 2.0 is supported");
		});
	});
});

```
