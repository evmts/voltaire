---
title: How to Detect Phishing Addresses
description: Identify potential phishing addresses using address comparison techniques.
---

## Goal

Detect address poisoning and phishing attacks by comparing addresses.

## Address Poisoning Detection

Attackers create addresses with matching prefix/suffix to trick users:

```ts
import { Address } from '@voltaire/primitives'

function detectAddressPoisoning(
  expected: string,
  suspicious: string,
  matchLength = 4
): { isPotentialPhish: boolean; matchedChars: number } {
  const e = Address.fromHex(expected).toHex().toLowerCase()
  const s = Address.fromHex(suspicious).toHex().toLowerCase()

  // Check if addresses are different but share prefix/suffix
  if (e === s) return { isPotentialPhish: false, matchedChars: 40 }

  // Count matching prefix chars (after 0x)
  let prefixMatch = 0
  for (let i = 2; i < 42 && e[i] === s[i]; i++) prefixMatch++

  // Count matching suffix chars
  let suffixMatch = 0
  for (let i = 41; i >= 2 && e[i] === s[i]; i--) suffixMatch++

  const totalMatched = prefixMatch + suffixMatch
  const isPotentialPhish = prefixMatch >= matchLength || suffixMatch >= matchLength

  return { isPotentialPhish, matchedChars: totalMatched }
}

// Example: attacker created similar address
const realAddress = "0x742d35Cc6634C0532925a3b844Bc9e7595f251e3"
const fakeAddress = "0x742d35Cc0000000000000000000000007595f251e3" // matches prefix/suffix

const result = detectAddressPoisoning(realAddress, fakeAddress)
if (result.isPotentialPhish) {
  console.warn('Potential phishing address detected!')
}
```

## Validate Against Known Addresses

```ts
import { Address } from '@voltaire/primitives'

class AddressBook {
  private known = new Map<string, string>()

  add(label: string, address: string) {
    const normalized = Address.fromHex(address).toHex().toLowerCase()
    this.known.set(normalized, label)
  }

  verify(address: string): { known: boolean; label?: string; similar?: string[] } {
    const normalized = Address.fromHex(address).toHex().toLowerCase()

    if (this.known.has(normalized)) {
      return { known: true, label: this.known.get(normalized) }
    }

    // Find similar addresses (potential poisoning)
    const similar: string[] = []
    for (const [known, label] of this.known) {
      const result = detectAddressPoisoning(known, normalized)
      if (result.isPotentialPhish) {
        similar.push(`${label} (${known})`)
      }
    }

    return { known: false, similar }
  }
}

const book = new AddressBook()
book.add('My Wallet', '0x742d35Cc6634C0532925a3b844Bc9e7595f251e3')

const check = book.verify('0x742d35Cc0000000000000000000000007595f251e3')
if (check.similar?.length) {
  console.warn('Similar to known addresses:', check.similar)
}
```

## Short Address Display Warning

```ts
import { Address } from '@voltaire/primitives'

function safeAddressDisplay(address: string): string {
  const addr = Address.fromHex(address)
  const hex = addr.toHex()

  // Show more characters than typical phishing addresses match
  const prefix = hex.slice(0, 10)  // 0x + 8 chars
  const suffix = hex.slice(-8)     // 8 chars

  return `${prefix}...${suffix}`
}

// Better: always show full address in confirmations
function confirmTransaction(to: string, amount: bigint) {
  const fullAddress = Address.fromHex(to).toHex()
  console.log(`Sending to: ${fullAddress}`)  // Show FULL address
  console.log(`Amount: ${amount}`)
}
```

## Red Flags

1. Address matches first/last 4+ characters of known address
2. Address received small "dust" transaction recently
3. Address not in your contact book but looks familiar
4. Transaction history shows no prior interaction

## See Also

- [Address Validation](/ghosts/security/how-to-validate-address)
- [EIP-55 Checksum](/ghosts/security/how-to-checksum-address)
