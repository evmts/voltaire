---
title: How to Use BN254 for ZK Proofs
description: Use BN254 pairing for zkSNARK verification on Ethereum
---

## Goal

Verify zkSNARK proofs using BN254 pairing operations (EVM precompiles 0x06-0x08).

## Example (TypeScript)

```typescript
import { bn254Ark, Hex, Bytes64 } from '@tevm/voltaire/crypto';

// G1 point addition (precompile 0x06)
const g1a = Hex.toBytes('0x0000...0001' + '0000...0002'); // 64 bytes
const g1b = Hex.toBytes('0x0000...0001' + '0000...0002');
const addInput = new Uint8Array([...g1a, ...g1b]);
const addOutput = Bytes64();
await bn254Ark.g1Add(addInput, addOutput);

// G1 scalar multiplication (precompile 0x07)
const point = Hex.toBytes('0x0000...0001' + '0000...0002'); // 64 bytes
const scalar = Hex.toBytes('0x0000...0003'); // 32 bytes
const mulInput = new Uint8Array([...point, ...scalar]);
const mulOutput = Bytes64();
await bn254Ark.g1Mul(mulInput, mulOutput);
```

## Groth16 Verification

```typescript
// Verify Groth16 proof using pairing check (precompile 0x08)
async function verifyGroth16(
  proof: { A: Uint8Array; B: Uint8Array; C: Uint8Array },
  vk: { alpha: Uint8Array; beta: Uint8Array; gamma: Uint8Array; delta: Uint8Array },
  publicInputs: Uint8Array
): Promise<boolean> {
  // Build pairing input: 3 pairs of (G1, G2) points
  // e(A, B) * e(-alpha, beta) * e(-C, delta) * e(inputs, gamma) = 1

  const pairs = new Uint8Array(192 * 4); // 4 pairs, 192 bytes each

  // Set proof.A with proof.B
  pairs.set(proof.A, 0);
  pairs.set(proof.B, 64);

  // Set negated alpha with beta
  pairs.set(negateG1(vk.alpha), 192);
  pairs.set(vk.beta, 256);

  // Set negated C with delta
  pairs.set(negateG1(proof.C), 384);
  pairs.set(vk.delta, 448);

  // Set public inputs contribution with gamma
  pairs.set(publicInputs, 576);
  pairs.set(vk.gamma, 640);

  return await bn254Ark.pairingCheck(pairs);
}
```

## Pairing Check

```typescript
// Direct pairing check for custom ZK systems
const g1Point = Hex.toBytes(
  '0x0000000000000000000000000000000000000000000000000000000000000001' +
  '0000000000000000000000000000000000000000000000000000000000000002'
);
const g2Point = Hex.toBytes(
  '0x198e9393920d483a7260bfb731fb5d25f1aa493335a9e71297e485b7aef312c2' +
  '1800deef121f1e76426a00665e5c4479674322d4f75edadd46debd5cd992f6ed' +
  '090689d0585ff075ec9e99ad690c3395bc4b313370b38ef355acdadcd122975b' +
  '12c85ea5db8c6deb4aab71808dcb408fe3d1e7690c43d37b4ce6cc0166fa7daa'
);

const pairs = new Uint8Array([...g1Point, ...g2Point]);
const success = await bn254Ark.pairingCheck(pairs);
```

## Gas Costs (EIP-1108)

- ECADD (0x06): 150 gas
- ECMUL (0x07): 6,000 gas
- ECPAIRING (0x08): 45,000 + 34,000 per pair

Groth16 verification (~3 pairs): ~147,000 gas

## Related

- [BN254 Overview](/crypto/bn254)
- [BN254 Pairing](/crypto/bn254/pairing)
- [BN254 Precompiles](/crypto/bn254/precompiles)
