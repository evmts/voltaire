---
title: Method-Based API
description: Direct method calls with branded primitive parameters and type-safe responses
---

<Warning>
**This page is a placeholder.** All examples on this page are currently AI-generated and are not correct. This documentation will be completed in the future with accurate, tested examples.
</Warning>

# Method-Based API

Request constructors create type-safe JSON-RPC requests with branded primitive parameters.

## Request Constructors

Create requests using data-first constructors:

```typescript
import * as Rpc from 'tevm/jsonrpc';
import * as Address from 'tevm/Address';

const address = Address('0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb0');

// Create requests using constructors
const blockRequest = Rpc.Eth.BlockNumberRequest();
const balanceRequest = Rpc.Eth.GetBalanceRequest(address, 'latest');
const callRequest = Rpc.Eth.CallRequest(params, 'latest');

// Send through provider
const blockResponse = await provider.request(blockRequest);
const balanceResponse = await provider.request(balanceRequest);
const callResponse = await provider.request(callRequest);
```

### Request Pattern

All request constructors follow this signature:

```typescript
Rpc.Eth.MethodNameRequest(params, options?) → JsonRpcRequest<T>
```

- **`Rpc.Eth.MethodName`** - Request constructor (e.g., `CallRequest`, `GetBalanceRequest`)
- **`params`** - Branded primitive types (Address, Hash, Hex, etc.)
- **`options`** - Optional request configuration
- **Returns** - Branded request type containing method and params

## Branded Primitive Parameters

All parameters use Tevm's branded primitive types for compile-time safety:

```typescript
import * as Rpc from 'tevm/jsonrpc';
import * as Address from 'tevm/Address';
import * as Hash from 'tevm/Hash';
import * as Hex from 'tevm/Hex';

// Construct branded types
const address = Address('0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb0');
const blockHash = Hash('0x...');
const data = Hex('0x70a08231...');

// Create requests - type-checked at compile time
const balanceReq = Rpc.Eth.GetBalanceRequest(address, 'latest');
const blockReq = Rpc.Eth.GetBlockByHashRequest(blockHash, true);

// Send requests
const balance = await provider.request(balanceReq);
const block = await provider.request(blockReq);
```

### Type Safety Benefits

TypeScript catches errors at compile time:

```typescript
import * as Rpc from 'tevm/jsonrpc';
import * as Address from 'tevm/Address';

// ❌ Compile error: string not assignable to Address
const badReq = Rpc.Eth.GetBalanceRequest('0x...', 'latest');

// ✅ Correct: use branded Address
const goodReq = Rpc.Eth.GetBalanceRequest(Address('0x...'), 'latest');

// ❌ Compile error: can't mix Hash and Address
const mixedReq = Rpc.Eth.GetBlockByHashRequest(address, true);

// ✅ Correct: use proper type
const hashReq = Rpc.Eth.GetBlockByHashRequest(hash, true);
```

## Response Handling

### Response Structure

Methods return `Response<T>` containing either result or error:

```typescript
type Response<T> =
  | { result: T; error?: never }
  | { result?: never; error: RpcError };

interface RpcError {
  code: number;
  message: string;
  data?: unknown;
}
```

### Checking Results

Always check for errors before using result:

```typescript
import * as Rpc from 'tevm/jsonrpc';

const request = Rpc.Eth.CallRequest(params);
const response = await provider.request(request);

if (response.error) {
  console.error('RPC error:', response.error.code, response.error.message);
  return;
}

// Safe to use result
const result = response.result;
console.log('Call result:', result);
```

### Type Inference

Return types are automatically inferred:

```typescript
import * as Rpc from 'tevm/jsonrpc';

// TypeScript knows blockNumber is Response<Quantity>
const blockNumReq = Rpc.Eth.BlockNumberRequest();
const blockNumber = await provider.request(blockNumReq);

// TypeScript knows balance is Response<Quantity>
const balanceReq = Rpc.Eth.GetBalanceRequest(address, 'latest');
const balance = await provider.request(balanceReq);

// TypeScript knows callResult is Response<Hex>
const callReq = Rpc.Eth.CallRequest(params);
const callResult = await provider.request(callReq);
```

## BlockTag Parameter

Many requests accept `BlockTag` to specify block context:

```typescript
import * as Rpc from 'tevm/jsonrpc';
import * as Address from 'tevm/Address';

type BlockTag =
  | 'latest'      // Most recent block
  | 'earliest'    // Genesis block
  | 'pending'     // Pending block
  | 'safe'        // Safe head block
  | 'finalized'   // Finalized block
  | string;       // Specific block number (hex)

const address = Address('0x...');

// Usage with different block tags
const latestReq = Rpc.Eth.GetBalanceRequest(address, 'latest');
const finalizedReq = Rpc.Eth.GetBalanceRequest(address, 'finalized');
const historicalReq = Rpc.Eth.GetBalanceRequest(address, '0x112A880'); // Block 18,000,000
```

## Request Options

Optional configuration for requests:

```typescript
interface RequestOptions {
  timeout?: number;      // Request timeout in ms
  retry?: number;        // Number of retries
  retryDelay?: number;   // Delay between retries in ms
}

// Usage (if supported by request constructor)
const request = Rpc.Eth.CallRequest(params, {
  timeout: 5000,
  retry: 3,
  retryDelay: 1000
});
const result = await provider.request(request);
```

## Method Categories

### Read Operations

```typescript
import * as Rpc from 'tevm/jsonrpc';
import * as Address from 'tevm/Address';

const address = Address('0x...');

// Get block number
const blockNumReq = Rpc.Eth.BlockNumberRequest();
const blockNum = await provider.request(blockNumReq);

// Get balance
const balanceReq = Rpc.Eth.GetBalanceRequest(address, 'latest');
const balance = await provider.request(balanceReq);

// Get transaction count (nonce)
const nonceReq = Rpc.Eth.GetTransactionCountRequest(address, 'latest');
const nonce = await provider.request(nonceReq);

// Get contract code
const codeReq = Rpc.Eth.GetCodeRequest(address, 'latest');
const code = await provider.request(codeReq);

// Get storage slot
const storageReq = Rpc.Eth.GetStorageAtRequest(address, slot, 'latest');
const storage = await provider.request(storageReq);
```

### Contract Calls

```typescript
import * as Rpc from 'tevm/jsonrpc';
import * as Address from 'tevm/Address';
import * as Hex from 'tevm/Hex';

// Execute read-only contract call
const callReq = Rpc.Eth.CallRequest({
  to: Address('0x...'),
  data: Hex('0x70a08231...')  // Function selector + encoded params
}, 'latest');
const result = await provider.request(callReq);

// Estimate gas for transaction
const gasReq = Rpc.Eth.EstimateGasRequest({
  from: Address('0x...'),
  to: Address('0x...'),
  value: '0xDE0B6B3A7640000',  // 1 ETH in wei
  data: Hex('0x...')
});
const gasEstimate = await provider.request(gasReq);
```

### Transaction Operations

```typescript
import * as Rpc from 'tevm/jsonrpc';
import * as Hash from 'tevm/Hash';
import * as Hex from 'tevm/Hex';

// Submit signed transaction
const sendReq = Rpc.Eth.SendRawTransactionRequest(
  Hex('0x...')  // Signed transaction bytes
);
const txHash = await provider.request(sendReq);

// Get transaction by hash
const txReq = Rpc.Eth.GetTransactionByHashRequest(Hash('0x...'));
const tx = await provider.request(txReq);

// Get transaction receipt
const receiptReq = Rpc.Eth.GetTransactionReceiptRequest(Hash('0x...'));
const receipt = await provider.request(receiptReq);
```

### Block Operations

```typescript
import * as Rpc from 'tevm/jsonrpc';

// Get block by number
const blockReq = Rpc.Eth.GetBlockByNumberRequest('latest', true);
const block = await provider.request(blockReq);

// Get block by hash
const blockHashReq = Rpc.Eth.GetBlockByHashRequest(blockHash, false);
const blockByHash = await provider.request(blockHashReq);

// Get uncle count
const uncleReq = Rpc.Eth.GetUncleCountByBlockNumberRequest('latest');
const uncleCount = await provider.request(uncleReq);
```

### Log Queries

```typescript
import * as Rpc from 'tevm/jsonrpc';
import * as Address from 'tevm/Address';
import * as Hash from 'tevm/Hash';

// Query logs
const logsReq = Rpc.Eth.GetLogsRequest({
  fromBlock: 'earliest',
  toBlock: 'latest',
  address: Address('0x...'),
  topics: [Hash('0x...')]
});
const logs = await provider.request(logsReq);
```

## Error Codes

Common JSON-RPC error codes:

| Code | Message | Description |
|------|---------|-------------|
| `-32700` | Parse error | Invalid JSON |
| `-32600` | Invalid request | Missing required fields |
| `-32601` | Method not found | Method doesn't exist |
| `-32602` | Invalid params | Wrong parameter types |
| `-32603` | Internal error | Server-side error |
| `3` | Execution reverted | Contract execution failed |

See [Error Handling](/jsonrpc-provider/error-handling) for detailed error patterns.

## Best Practices

1. **Always check for errors** before using results
2. **Use branded types** for all parameters
3. **Reuse type instances** - don't reconstruct on every call
4. **Set appropriate timeouts** for long-running operations
5. **Handle network failures** with retry logic
6. **Batch independent requests** with Promise.all

```typescript
import * as Rpc from 'tevm/jsonrpc';
import * as Address from 'tevm/Address';

const address = Address('0x...');

// ✅ Good: batch independent requests
const blockReq = Rpc.Eth.BlockNumberRequest();
const balanceReq = Rpc.Eth.GetBalanceRequest(address, 'latest');
const nonceReq = Rpc.Eth.GetTransactionCountRequest(address, 'latest');

const [block, balance, nonce] = await Promise.all([
  provider.request(blockReq),
  provider.request(balanceReq),
  provider.request(nonceReq)
]);

// ❌ Bad: sequential requests (slower)
const block = await provider.request(Rpc.Eth.BlockNumberRequest());
const balance = await provider.request(Rpc.Eth.GetBalanceRequest(address, 'latest'));
const nonce = await provider.request(Rpc.Eth.GetTransactionCountRequest(address, 'latest'));
```

## Method Reference

<CardGroup cols={3}>
  <Card title="eth Methods" icon="ethereum" href="/jsonrpc-provider/eth-methods">
    40 standard Ethereum methods for blocks, transactions, state, and logs.
  </Card>

  <Card title="debug Methods" icon="bug" href="/jsonrpc-provider/debug-methods">
    5 debugging methods for transaction tracing and analysis.
  </Card>

  <Card title="engine Methods" icon="gears" href="/jsonrpc-provider/engine-methods">
    20 consensus layer methods for Engine API integration.
  </Card>
</CardGroup>

## Related

- [Type System](/jsonrpc-provider/type-system) - Auto-generated types and branded primitives
- [Events](/jsonrpc-provider/events) - Async generator subscriptions
- [Error Handling](/jsonrpc-provider/error-handling) - Comprehensive error patterns
- [Usage Patterns](/jsonrpc-provider/usage-patterns) - Common recipes and examples
