---
title: Method-Based API
description: Direct method calls with branded primitive parameters and type-safe responses
---

<Warning>
**This page is a placeholder.** All examples on this page are currently AI-generated and are not correct. This documentation will be completed in the future with accurate, tested examples.
</Warning>

# Method-Based API

Provider exposes JSON-RPC methods as direct function calls with strongly-typed branded primitive parameters.

## Direct Method Calls

Call methods directly on the provider instead of using generic `request()`:

```typescript
// Direct method calls
await provider.eth_blockNumber();
await provider.eth_getBalance(address, 'latest');
await provider.eth_call(params, 'latest');
```

### Method Pattern

All methods follow this signature:

```typescript
provider.methodName(params, options?) → Promise<Response<T>>
```

- **`methodName`** - JSON-RPC method (e.g., `eth_call`, `eth_getBalance`)
- **`params`** - Branded primitive types (Address, Hash, Hex, etc.)
- **`options`** - Optional request configuration
- **Returns** - Promise resolving to Response containing result or error

## Branded Primitive Parameters

All parameters use Voltaire's branded primitive types for compile-time safety:

```typescript
import * as Address from '@tevm/voltaire/Address';
import { Keccak256 } from '@tevm/voltaire/crypto/Keccak256';
import * as Hex from '@tevm/voltaire/Hex';

// Construct branded types
const address = Address('0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb0');
const blockHash = Hash('0x...');
const data = Hex('0x70a08231...');

// Use in method calls - type-checked at compile time
const balance = await provider.eth_getBalance(address, 'latest');
const block = await provider.eth_getBlockByHash(blockHash, true);
```

### Type Safety Benefits

TypeScript catches errors at compile time:

```typescript
// ❌ Compile error: string not assignable to Address
await provider.eth_getBalance('0x...', 'latest');

// ✅ Correct: use branded Address
await provider.eth_getBalance(Address('0x...'), 'latest');

// ❌ Compile error: can't mix Hash and Address
await provider.eth_getBlockByHash(address, true);

// ✅ Correct: use proper type
await provider.eth_getBlockByHash(hash, true);
```

## Response Handling

### Response Structure

Methods return `Response<T>` containing either result or error:

```typescript
type Response<T> =
  | { result: T; error?: never }
  | { result?: never; error: RpcError };

interface RpcError {
  code: number;
  message: string;
  data?: unknown;
}
```

### Checking Results

Always check for errors before using result:

```typescript
const response = await provider.eth_call(params);

if (response.error) {
  console.error('RPC error:', response.error.code, response.error.message);
  return;
}

// Safe to use result
const result = response.result;
console.log('Call result:', result);
```

### Type Inference

Return types are automatically inferred:

```typescript
// TypeScript knows blockNumber is Response<Quantity>
const blockNumber = await provider.eth_blockNumber();

// TypeScript knows balance is Response<Quantity>
const balance = await provider.eth_getBalance(address, 'latest');

// TypeScript knows callResult is Response<Hex>
const callResult = await provider.eth_call(params);
```

## BlockTag Parameter

Many methods accept `BlockTag` to specify block context:

```typescript
type BlockTag =
  | 'latest'      // Most recent block
  | 'earliest'    // Genesis block
  | 'pending'     // Pending block
  | 'safe'        // Safe head block
  | 'finalized'   // Finalized block
  | string;       // Specific block number (hex)

// Usage
await provider.eth_getBalance(address, 'latest');
await provider.eth_getBalance(address, 'finalized');
await provider.eth_getBalance(address, '0x112A880'); // Block 18,000,000
```

## Request Options

Optional configuration for method calls:

```typescript
interface RequestOptions {
  timeout?: number;      // Request timeout in ms
  retry?: number;        // Number of retries
  retryDelay?: number;   // Delay between retries in ms
}

// Usage
const result = await provider.eth_call(params, {
  timeout: 5000,
  retry: 3,
  retryDelay: 1000
});
```

## Method Categories

### Read Operations

```typescript
// Get block number
const blockNum = await provider.eth_blockNumber();

// Get balance
const balance = await provider.eth_getBalance(address, 'latest');

// Get transaction count (nonce)
const nonce = await provider.eth_getTransactionCount(address, 'latest');

// Get contract code
const code = await provider.eth_getCode(address, 'latest');

// Get storage slot
const storage = await provider.eth_getStorageAt(address, slot, 'latest');
```

### Contract Calls

```typescript
import * as Address from '@tevm/voltaire/Address';
import * as Hex from '@tevm/voltaire/Hex';

// Execute read-only contract call
const result = await provider.eth_call({
  to: Address('0x...'),
  data: Hex('0x70a08231...')  // Function selector + encoded params
}, 'latest');

// Estimate gas for transaction
const gasEstimate = await provider.eth_estimateGas({
  from: Address('0x...'),
  to: Address('0x...'),
  value: '0xDE0B6B3A7640000',  // 1 ETH in wei
  data: Hex('0x...')
});
```

### Transaction Operations

```typescript
import { Keccak256 } from '@tevm/voltaire/crypto/Keccak256';
import * as Hex from '@tevm/voltaire/Hex';

// Submit signed transaction
const txHash = await provider.eth_sendRawTransaction(
  Hex('0x...')  // Signed transaction bytes
);

// Get transaction by hash
const tx = await provider.eth_getTransactionByHash(
  Hash('0x...')
);

// Get transaction receipt
const receipt = await provider.eth_getTransactionReceipt(
  Hash('0x...')
);
```

### Block Operations

```typescript
// Get block by number
const block = await provider.eth_getBlockByNumber('latest', true);

// Get block by hash
const block = await provider.eth_getBlockByHash(blockHash, false);

// Get uncle count
const uncleCount = await provider.eth_getUncleCountByBlockNumber('latest');
```

### Log Queries

```typescript
// Query logs
const logs = await provider.eth_getLogs({
  fromBlock: 'earliest',
  toBlock: 'latest',
  address: Address('0x...'),
  topics: [Hash('0x...')]
});
```

## Error Codes

Common JSON-RPC error codes:

| Code | Message | Description |
|------|---------|-------------|
| `-32700` | Parse error | Invalid JSON |
| `-32600` | Invalid request | Missing required fields |
| `-32601` | Method not found | Method doesn't exist |
| `-32602` | Invalid params | Wrong parameter types |
| `-32603` | Internal error | Server-side error |
| `3` | Execution reverted | Contract execution failed |

See [Error Handling](/jsonrpc-provider/error-handling) for detailed error patterns.

## Best Practices

1. **Always check for errors** before using results
2. **Use branded types** for all parameters
3. **Reuse type instances** - don't reconstruct on every call
4. **Set appropriate timeouts** for long-running operations
5. **Handle network failures** with retry logic
6. **Batch independent requests** with Promise.all

```typescript
// ✅ Good: batch independent requests
const [block, balance, nonce] = await Promise.all([
  provider.eth_blockNumber(),
  provider.eth_getBalance(address, 'latest'),
  provider.eth_getTransactionCount(address, 'latest')
]);

// ❌ Bad: sequential requests (slower)
const block = await provider.eth_blockNumber();
const balance = await provider.eth_getBalance(address, 'latest');
const nonce = await provider.eth_getTransactionCount(address, 'latest');
```

## Method Reference

<CardGroup cols={3}>
  <Card title="eth Methods" icon="ethereum" href="/jsonrpc-provider/eth-methods">
    40 standard Ethereum methods for blocks, transactions, state, and logs.
  </Card>

  <Card title="debug Methods" icon="bug" href="/jsonrpc-provider/debug-methods">
    5 debugging methods for transaction tracing and analysis.
  </Card>

  <Card title="engine Methods" icon="gears" href="/jsonrpc-provider/engine-methods">
    20 consensus layer methods for Engine API integration.
  </Card>
</CardGroup>

## Related

- [Type System](/jsonrpc-provider/type-system) - Auto-generated types and branded primitives
- [Events](/jsonrpc-provider/events) - Async generator subscriptions
- [Error Handling](/jsonrpc-provider/error-handling) - Comprehensive error patterns
- [Usage Patterns](/jsonrpc-provider/usage-patterns) - Common recipes and examples
