---
title: BN254 (alt_bn128)
description: Pairing-friendly elliptic curve for zkSNARK verification, Ethereum precompiles EIP-196/197
---

# BN254 (alt_bn128)

Barreto-Naehrig pairing-friendly curve standardized in Ethereum as alt_bn128. Primary curve for on-chain zkSNARK verification via precompiles 0x06-0x08.

## Overview

BN254 (also BN128, alt_bn128) is THE pairing curve for Ethereum zkSNARKs. Activated in Byzantium fork (2017), it enables privacy protocols, L2 proofs, and zero-knowledge applications.

### Why BN254 on Ethereum?

**Gas-Efficient**: Precompiled contracts make zkSNARK verification affordable
**Ecosystem**: Groth16, PlonK, and most zk-proof systems support BN254
**Adoption**: Tornado Cash, zkSync, Aztec, Polygon zkEVM all use BN254
**Tooling**: Mature libraries (snarkjs, circom, libsnark) 

**Security Note**: ~100-bit security (weaker than BLS12-381's 128-bit). Sufficient for current use but may need migration by 2030.

## Mathematical Foundation

### Curve Equations

**G1 (base field Fp)**:
```
y² = x³ + 3
```

**G2 (extension field Fp2)**:
```
y² = x³ + 3/(ξ)  where ξ = 9 + i
```

### Field Parameters

**Base Field Modulus (p)**: 254-bit prime
```
p = 21888242871839275222246405745257275088696311157297823662689037894645226208583
```

**Scalar Field Modulus (r)**: Curve order
```
r = 21888242871839275222246405745257275088548364400416034343698204186575808495617
```

**Embedding Degree**: k = 12 (Fp12 target group)

**Curve Parameter**: t = 4965661367192848881 (BN curve)

## Quick Start

```typescript
import { bn254 } from '@tevm/voltaire/crypto';

// G1 point addition
const g1a = Hex.toBytes('0x0000000000000000000000000000000000000000000000000000000000000001' +
                        '0000000000000000000000000000000000000000000000000000000000000002');
const g1b = Hex.toBytes('0x0000000000000000000000000000000000000000000000000000000000000001' +
                        '0000000000000000000000000000000000000000000000000000000000000002');
const input = new Uint8Array([...g1a, ...g1b]);
const output = Bytes64();
await bn254.g1Add(input, output);

// G1 scalar multiplication
const point = Hex.toBytes('0x0000000000000000000000000000000000000000000000000000000000000001' +
                          '0000000000000000000000000000000000000000000000000000000000000002');
const scalar = Hex.toBytes('0x0000000000000000000000000000000000000000000000000000000000000003');
const mulInput = new Uint8Array([...point, ...scalar]);
const mulOutput = Bytes64();
await bn254.g1Mul(mulInput, mulOutput);

// Pairing check (zkSNARK verification)
const g1Point = Hex.toBytes('0x0000000000000000000000000000000000000000000000000000000000000001' +
                            '0000000000000000000000000000000000000000000000000000000000000002');
const g2Point = Hex.toBytes('0x198e9393920d483a7260bfb731fb5d25f1aa493335a9e71297e485b7aef312c2' +
                            '1800deef121f1e76426a00665e5c4479674322d4f75edadd46debd5cd992f6ed' +
                            '090689d0585ff075ec9e99ad690c3395bc4b313370b38ef355acdadcd122975b' +
                            '12c85ea5db8c6deb4aab71808dcb408fe3d1e7690c43d37b4ce6cc0166fa7daa');
const pairs = new Uint8Array([...g1Point, ...g2Point]); // Single pair
const success = await bn254.pairingCheck(pairs);
```

## Documentation

### Core Concepts

- [**Pairing**](./pairing) - Optimal ate pairing, Miller loop, final exponentiation
- [**Precompiles**](./precompiles) - EIP-196/197 precompiled contracts (0x06-0x08)
- [**zkSNARK Usage**](./zk-usage) - Groth16, PlonK, proof verification patterns

### Operations

- [**G1 Operations**](./g1-operations) - Point addition, scalar mul, serialization
- [**G2 Operations**](./g2-operations) - Extension field operations, subgroup checks

### Reference

- [**Test Vectors**](./test-vectors) - Official EIP-196/197 test vectors
- [**Performance**](./performance) - Benchmarks, gas costs, optimizations
- [**Usage Patterns**](./usage-patterns) - Privacy protocols, L2 proofs, DeFi

## Precompile Addresses

**EIP-196 (Byzantium)**:
- `0x06`: ECADD - G1 point addition
- `0x07`: ECMUL - G1 scalar multiplication

**EIP-197 (Byzantium)**:
- `0x08`: ECPAIRING - Pairing check

**EIP-1108 (Istanbul)**: Reduced gas costs for zkSNARK affordability

## Point Formats

### G1 Points (64 bytes)

```
| x-coordinate | y-coordinate |
|   32 bytes   |   32 bytes   |
```

Both big-endian Fp elements. Infinity represented as (0, 0).

### G2 Points (128 bytes)

```
| x.c0 | x.c1 | y.c0 | y.c1 |
|  32  |  32  |  32  |  32  |
```

Fp2 elements: x = x.c0 + x.c1·i, y = y.c0 + y.c1·i

## Implementation

**Pure Zig**: `src/crypto/bn254/*.zig`
- G1/G2 projective coordinates
- Field arithmetic (Montgomery form)
- NAF scalar multiplication
- Optimal ate pairing

**Rust (arkworks)**: `src/crypto/bn254_arkworks.zig`
- Production-grade, audited
- Used for precompile implementation
- Faster than pure Zig (~2x)

**TypeScript**: Via FFI to Zig/Rust

## Gas Costs

**EIP-196 (after Istanbul)**:
- ECADD: 150 gas
- ECMUL: 6,000 gas

**EIP-197 (after Istanbul)**:
- ECPAIRING base: 45,000 gas
- ECPAIRING per pair: 34,000 gas

**Groth16 Verification** (~3 pairs): 45,000 + 34,000×3 = 147,000 gas

## Security

**Current Security**: ~100-bit (NFS attacks, ~2016 estimates)

**Concerns**:
- Weaker than BLS12-381 (128-bit)
- May need migration by 2030 for long-term security

**Mitigations**:
- Sufficient for current protocols
- Monitor cryptanalysis research
- Plan migration path to BLS12-381 or BLS24

**Subgroup Attacks**: Critical to validate G2 subgroup membership

## Use Cases

**Privacy**: Tornado Cash, Aztec, zkBob
**L2 Scaling**: zkSync, Polygon zkEVM, Scroll
**Identity**: zk-proofs for authentication
**DeFi**: Private trading, dark pools
**Voting**: On-chain governance with privacy

## Performance

**Native (arkworks)**:
- G1 add: ~5 μs
- G1 mul: ~40 μs  
- G2 add: ~10 μs
- G2 mul: ~120 μs
- Pairing (single): ~600 μs
- Pairing check (3 pairs): ~2 ms

**vs BLS12-381**:
- ~2x faster pairing
- Less secure (100-bit vs 128-bit)

## Related

- [BLS12-381](/crypto/bls12-381) - More secure pairing curve
- [KZG Commitments](/crypto/kzg) - Uses BLS12-381 (not BN254)
- [Precompiles: BN254](/precompiles/bn254) - Implementation details

## References

- [EIP-196: ECADD and ECMUL Precompiles](https://eips.ethereum.org/EIPS/eip-196)
- [EIP-197: ECPAIRING Precompile](https://eips.ethereum.org/EIPS/eip-197)
- [EIP-1108: Reduce Gas Costs](https://eips.ethereum.org/EIPS/eip-1108)
- [BN254 For The Rest Of Us](https://hackmd.io/@jpw/bn254)
