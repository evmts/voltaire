---
title: Transaction
description: Complete Ethereum transaction encoding/decoding for all transaction types
---

import { Tabs, TabItem, Card, CardGrid, Aside } from '@astrojs/starlight/components';

# Transaction

Complete Ethereum transaction implementation supporting all transaction types from Legacy to EIP-7702.

## Overview

Transaction module provides type-safe encoding, decoding, signing, and hashing for all Ethereum transaction types. Supports Legacy (Type 0), EIP-2930 (Type 1), EIP-1559 (Type 2), EIP-4844 (Type 3), and EIP-7702 (Type 4) transactions with full RLP serialization.

## Quick Start

<Tabs>
<TabItem label="Basic Usage">
```typescript
import * as Transaction from '@tevm/voltaire/Transaction'
import * as Address from '@tevm/voltaire/Address'

// Create a transaction
const tx: Transaction.EIP1559 = {
  type: Transaction.Type.EIP1559,
  chainId: 1n,
  nonce: 0n,
  maxPriorityFeePerGas: 1000000000n,
  maxFeePerGas: 20000000000n,
  gasLimit: 21000n,
  to: addressBytes,
  value: 1000000000000000000n,
  data: new Uint8Array(),
  accessList: [],
  yParity: 0,
  r: signatureR,
  s: signatureS,
}

// Serialize to bytes
const serialized = Transaction.serialize(tx)

// Compute transaction hash
const hash = Transaction.hash(tx)

// Get signing hash
const signingHash = Transaction.getSigningHash(tx)

// Recover sender from signature
const sender = Transaction.getSender(tx)

// Deserialize from bytes
const decoded = Transaction.deserialize(serialized)

// Detect transaction type from bytes
const type = Transaction.detectType(serialized)
```
</TabItem>

<TabItem label="Type-Specific Operations">
```typescript
import * as Transaction from '@tevm/voltaire/Transaction'

// Legacy transaction
const legacy: Transaction.Legacy = {
  type: Transaction.Type.Legacy,
  nonce: 0n,
  gasPrice: 20000000000n,
  gasLimit: 21000n,
  to: addressBytes,
  value: 1000000000000000000n,
  data: new Uint8Array(),
  v: 27n,
  r: signatureR,
  s: signatureS,
}

// Get chain ID from legacy v value
const chainId = Transaction.getChainId(legacy)

// EIP-1559 transaction
const eip1559: Transaction.EIP1559 = { /* ... */ }
const effectiveGasPrice = Transaction.EIP1559.getEffectiveGasPrice(
  eip1559,
  baseFee
)

// EIP-4844 blob transaction
const eip4844: Transaction.EIP4844 = {
  type: Transaction.Type.EIP4844,
  chainId: 1n,
  nonce: 0n,
  maxPriorityFeePerGas: 1000000000n,
  maxFeePerGas: 20000000000n,
  gasLimit: 100000n,
  to: addressBytes,
  value: 0n,
  data: new Uint8Array(),
  accessList: [],
  maxFeePerBlobGas: 1000000000n,
  blobVersionedHashes: [hash1, hash2],
  yParity: 0,
  r: signatureR,
  s: signatureS,
}

const blobCost = Transaction.EIP4844.getBlobGasCost(eip4844, blobBaseFee)
```
</TabItem>

<TabItem label="Utilities">
```typescript
import * as Transaction from '@tevm/voltaire/Transaction'

// Format for display
const formatted = Transaction.format(tx)
// "EIP-1559 tx to 0x..., value: 1 ETH, nonce: 0"

// Get gas price (handles all types)
const gasPrice = Transaction.getGasPrice(tx, baseFee)

// Check if transaction has access list
if (Transaction.hasAccessList(tx)) {
  const accessList = Transaction.getAccessList(tx)
}

// Get chain ID
const chainId = Transaction.getChainId(tx)

// Check if signed
if (Transaction.isSigned(tx)) {
  const sender = Transaction.getSender(tx)
}

// Assert signed (throws if not)
Transaction.assertSigned(tx)

// Verify signature
const isValid = Transaction.verifySignature(tx)
```
</TabItem>
</Tabs>

## Transaction Types

Ethereum supports five transaction types, each with different capabilities:

<CardGrid>
  <Card title="Legacy (Type 0)" icon="document">
    Original transaction format with fixed gas price.

    [View Legacy →](/primitives/transaction/legacy)
  </Card>

  <Card title="EIP-2930 (Type 1)" icon="list-format">
    Access list transactions for gas optimization.

    [View EIP-2930 →](/primitives/transaction/eip2930)
  </Card>

  <Card title="EIP-1559 (Type 2)" icon="star">
    Dynamic fee market with base fee and priority fee.

    [View EIP-1559 →](/primitives/transaction/eip1559)
  </Card>

  <Card title="EIP-4844 (Type 3)" icon="rocket">
    Blob transactions for L2 data availability.

    [View EIP-4844 →](/primitives/transaction/eip4844)
  </Card>

  <Card title="EIP-7702 (Type 4)" icon="puzzle">
    EOA delegation to smart contracts.

    [View EIP-7702 →](/primitives/transaction/eip7702)
  </Card>
</CardGrid>

## EIP Evolution Timeline

The transaction layer has evolved to support new capabilities with each hard fork:

```
2015 ── Legacy (0x00)
        └─ Fixed gasPrice
        └─ Simple nonce + v/r/s
        └─ 2 MB blocks

        │
        ├─ Replay protection (EIP-155)
        │  └─ Chain ID in v value

2020 ── EIP-2718 (Typed Transactions)
        │  └─ Extensible envelope
        │  └─ Future-proof structure

        ├─ EIP-2930 (0x01) - Berlin
        │  └─ Access lists (gas savings)
        │  └─ yParity format (0 or 1)

2021 ── EIP-1559 (0x02) - London
        │  └─ Base fee + priority fee
        │  └─ Automatic fee market
        │  └─ ETH burn mechanism

2024 ── EIP-4844 (0x03) - Dencun
        │  └─ Blob transactions
        │  └─ 128 KB blobs (6 max)
        │  └─ Separate blob gas pricing
        │  └─ L2 data availability

        ├─ EIP-7702 (0x04) - Pectra
        │  └─ EOA delegation
        │  └─ Account abstraction lite
        │  └─ Authorization list
```

**Key milestones:**
- **Legacy**: Foundation - simple send/call operations
- **EIP-155**: Security - replay protection across chains
- **EIP-2930**: Optimization - explicit state access declaration
- **EIP-1559**: Economics - transparent fee market
- **EIP-4844**: Scalability - L2 data availability at scale
- **EIP-7702**: Abstraction - EOAs execute smart contract logic

## Feature Comparison

| Aspect | Legacy | EIP-2930 | EIP-1559 | EIP-4844 | EIP-7702 |
|--------|--------|----------|----------|----------|----------|
| **Type byte** | 0x00 | 0x01 | 0x02 | 0x03 | 0x04 |
| **Hard fork** | Genesis | Berlin | London | Dencun | Pectra |
| **Gas pricing** | Fixed gasPrice | Fixed gasPrice | maxFee + priority | maxFee + priority | maxFee + priority |
| **Chain ID** | In v value | Explicit | Explicit | Explicit | Explicit |
| **Access lists** | ✗ | ✓ | ✓ | ✓ | ✓ |
| **Blob data** | ✗ | ✗ | ✗ | ✓ (6 max) | ✗ |
| **Authorization** | ✗ | ✗ | ✗ | ✗ | ✓ (delegation) |
| **Contract creation** | ✓ | ✓ | ✓ | ✗ | ✓ |
| **Signature format** | v/r/s (bigint) | yParity/r/s | yParity/r/s | yParity/r/s | yParity/r/s |

## Transaction Lifecycle

```
┌─────────────────────────────────────────────────────────┐
│ 1. CONSTRUCT                                            │
│    Set nonce, gasLimit, to, value, data, type, fees   │
├─────────────────────────────────────────────────────────┤
│ 2. HASH (Signing Hash)                                  │
│    keccak256(encoded fields) - what gets signed        │
├─────────────────────────────────────────────────────────┤
│ 3. SIGN                                                 │
│    secp256k1(signingHash) → r, s, yParity             │
├─────────────────────────────────────────────────────────┤
│ 4. SERIALIZE                                            │
│    RLP encode [type, fields...] → bytes                │
├─────────────────────────────────────────────────────────┤
│ 5. BROADCAST                                            │
│    Send to mempool / JSON-RPC endpoint                 │
├─────────────────────────────────────────────────────────┤
│ 6. MINE                                                 │
│    Included in block, executed, state changed          │
├─────────────────────────────────────────────────────────┤
│ 7. VERIFY                                               │
│    getSender() recovers signer from signature          │
└─────────────────────────────────────────────────────────┘
```

**Operations at each stage:**

1. **Construct**: Validate field values, ensure type-specific constraints
2. **Hash**: Compute signing hash (excludes signature fields)
3. **Sign**: Produce signature using sender's private key
4. **Serialize**: Encode to bytes for transmission
5. **Broadcast**: Send to network (JSON-RPC `eth_sendRawTransaction`)
6. **Mine**: Miner includes in block, state transitions execute
7. **Verify**: Validate signature and recover sender for audit trail

<Aside type="tip">
The signing hash is computed **before** serialization. This ensures the signature proves the transaction's immutability - any change to the transaction data invalidates the signature.
</Aside>

## Type Definitions

```typescript
// Transaction type enum
enum Type {
  Legacy = 0x00,
  EIP2930 = 0x01,
  EIP1559 = 0x02,
  EIP4844 = 0x03,
  EIP7702 = 0x04,
}

// Legacy transaction (Type 0)
type Legacy = {
  type: Type.Legacy
  nonce: bigint
  gasPrice: bigint
  gasLimit: bigint
  to: BrandedAddress | null
  value: bigint
  data: Uint8Array
  v: bigint
  r: Uint8Array
  s: Uint8Array
}

// EIP-2930 transaction (Type 1)
type EIP2930 = {
  type: Type.EIP2930
  chainId: bigint
  nonce: bigint
  gasPrice: bigint
  gasLimit: bigint
  to: BrandedAddress | null
  value: bigint
  data: Uint8Array
  accessList: AccessList
  yParity: number
  r: Uint8Array
  s: Uint8Array
}

// EIP-1559 transaction (Type 2)
type EIP1559 = {
  type: Type.EIP1559
  chainId: bigint
  nonce: bigint
  maxPriorityFeePerGas: bigint
  maxFeePerGas: bigint
  gasLimit: bigint
  to: BrandedAddress | null
  value: bigint
  data: Uint8Array
  accessList: AccessList
  yParity: number
  r: Uint8Array
  s: Uint8Array
}

// EIP-4844 transaction (Type 3)
type EIP4844 = {
  type: Type.EIP4844
  chainId: bigint
  nonce: bigint
  maxPriorityFeePerGas: bigint
  maxFeePerGas: bigint
  gasLimit: bigint
  to: BrandedAddress  // Cannot be null for blob transactions
  value: bigint
  data: Uint8Array
  accessList: AccessList
  maxFeePerBlobGas: bigint
  blobVersionedHashes: readonly VersionedHash[]
  yParity: number
  r: Uint8Array
  s: Uint8Array
}

// EIP-7702 transaction (Type 4)
type EIP7702 = {
  type: Type.EIP7702
  chainId: bigint
  nonce: bigint
  maxPriorityFeePerGas: bigint
  maxFeePerGas: bigint
  gasLimit: bigint
  to: BrandedAddress | null
  value: bigint
  data: Uint8Array
  accessList: AccessList
  authorizationList: AuthorizationList
  yParity: number
  r: Uint8Array
  s: Uint8Array
}

// Union type for all transactions
type Any = Legacy | EIP2930 | EIP1559 | EIP4844 | EIP7702
```

Source: [types.ts](https://github.com/evmts/voltaire/blob/main/src/primitives/Transaction/types.ts)

## Gas Fee Mechanisms

How fees work across transaction types:

<Tabs>
<TabItem label="Legacy (Type 0)">
```
Effective Gas Price = gasPrice
Total Gas Cost = gasLimit * gasPrice + value
```
- **Fixed price**: No market adaptation
- **Risk**: Overpay in low-fee periods, underpay in high-fee periods
</TabItem>

<TabItem label="EIP-2930/1559/4844 (Types 1-3)">
```
Base Fee = Set by protocol (burns to Ethereum)
Priority Fee = User tip to miner
maxFeePerGas = Maximum willing to pay per gas

Effective Gas Price = min(
  baseFee + priorityFeePerGas,
  maxFeePerGas
)
Total Gas Cost = gasLimit * effectiveGasPrice + value
```
- **Market driven**: Fee adapts to block fullness
- **Refunds**: If actual < max, difference refunded
- **Example**: Base fee 20 gwei, you offer 25 gwei max + 2 gwei tip
  - If block full: pay 20 + 2 = 22 gwei/gas
  - If block empty: pay 20 + 2 = 22 gwei/gas (no overpayment)
</TabItem>

<TabItem label="EIP-4844 (Type 3) - Blobs">
```
Gas Fee = gasLimit * effectiveGasPrice (same as EIP-1559)
Blob Fee = blobCount * maxFeePerBlobGas * BlobGasPerBlob

Total Cost = Gas Cost + Blob Cost + value
```
- **Separate pricing**: Blob gas independent from execution gas
- **Blob gas per blob**: 131,072 bytes per blob
- **Maximum blobs**: 6 blobs per transaction
- **Blob pricing**: Adapts like base fee, burns to chain
</TabItem>

<TabItem label="EIP-7702 (Type 4) - Authorization">
```
Gas Cost = gasLimit * effectiveGasPrice + value

Authorization costs:
- Each authorization: ~200 gas + secp256k1 verify
- Scales with authorizationList.length
```
- **Same fee structure**: EIP-1559 fees apply
- **Additional gas**: Authorizations increase intrinsic gas
- **Delegation overhead**: EOA proof of delegation
</TabItem>
</Tabs>

## API Documentation

<CardGrid>
  <Card title="Types" icon="seti:config">
    All transaction type definitions, enums, and type guards.

    [View types →](/primitives/transaction/types)
  </Card>

  <Card title="Detection" icon="magnifier">
    Detect transaction type from serialized bytes.

    [View detection →](/primitives/transaction/detection)
  </Card>

  <Card title="Serialization" icon="document">
    RLP encode and decode transactions.

    [View serialization →](/primitives/transaction/serialization)
  </Card>

  <Card title="Hashing" icon="approve-check-circle">
    Compute transaction and signing hashes.

    [View hashing →](/primitives/transaction/hashing)
  </Card>

  <Card title="Signing" icon="pen">
    Signature verification and sender recovery.

    [View signing →](/primitives/transaction/signing)
  </Card>

  <Card title="Utilities" icon="setting">
    Helper methods for gas, access lists, formatting, and more.

    [View utilities →](/primitives/transaction/utilities)
  </Card>

  <Card title="Usage Patterns" icon="open-book">
    Common patterns for building and working with transactions.

    [View usage patterns →](/primitives/transaction/usage-patterns)
  </Card>
</CardGrid>

## Architecture

Transaction module uses namespace pattern for tree-shaking:

```typescript
// Top-level operations work on any transaction type
Transaction.serialize(tx)      // Dispatches to type-specific serialize
Transaction.hash(tx)           // Dispatches to type-specific hash
Transaction.getSender(tx)      // Dispatches to type-specific getSender

// Type-specific namespaces for specialized operations
Transaction.Legacy.getChainId.call(legacyTx)
Transaction.EIP1559.getEffectiveGasPrice(eip1559Tx, baseFee)
Transaction.EIP4844.getBlobGasCost(eip4844Tx, blobBaseFee)

// Tree-shakeable imports
import { serialize } from '@tevm/voltaire/Transaction/serialize'
import { hash } from '@tevm/voltaire/Transaction/hash'
```

Each transaction type has its own namespace with type-specific methods:
- `Transaction.Legacy.*` - Legacy transaction operations
- `Transaction.EIP2930.*` - EIP-2930 operations
- `Transaction.EIP1559.*` - EIP-1559 operations (effective gas price)
- `Transaction.EIP4844.*` - EIP-4844 operations (blob gas cost)
- `Transaction.EIP7702.*` - EIP-7702 operations (authorization)

<Aside type="tip" title="Tree-shaking">
Import only what you need. Each transaction type's methods are independently tree-shakeable.
</Aside>

## Related Types

### Core Dependencies

<CardGrid stagger>
  <Card title="Address" icon="seti:config">
    20-byte Ethereum addresses. Used in `to` field and sender recovery.

    [View Address →](/primitives/address)
  </Card>

  <Card title="Hash" icon="document">
    32-byte hash values. Compute signing/transaction hashes via keccak256.

    [View Hash →](/primitives/hash)
  </Card>

  <Card title="Hex" icon="seti:text">
    Hex string utilities for encoding/decoding transaction data.

    [View Hex →](/primitives/hex)
  </Card>

  <Card title="RLP" icon="list-format">
    Recursive Length Prefix encoding. Core serialization format for all transactions.

    [View RLP →](/primitives/rlp)
  </Card>
</CardGrid>

### Type-Specific References

<CardGrid stagger>
  <Card title="AccessList" icon="open-book">
    Pre-declared account/storage access for gas optimization (EIP-2930+).

    [View AccessList →](/primitives/access-list)
  </Card>

  <Card title="Blob" icon="rocket">
    Blob data for L2 data availability (EIP-4844). 128 KB chunks.

    [View Blob →](/primitives/blob)
  </Card>

  <Card title="Authorization" icon="puzzle">
    EOA delegation authorization list for EIP-7702 account abstraction.

    [View Authorization →](/primitives/authorization)
  </Card>

  <Card title="FeeMarket" icon="star">
    Base fee and priority fee calculations. Context for EIP-1559+ transactions.

    [View FeeMarket →](/primitives/fee-market)
  </Card>

  <Card title="GasConstants" icon="setting">
    Gas intrinsic costs, opcode pricing. Essential for gas estimation.

    [View GasConstants →](/primitives/gas-constants)
  </Card>

  <Card title="Signature" icon="pen">
    ECDSA signature utilities (r, s, yParity). Used in signing and recovery.

    [View Signature →](/crypto/secp256k1)
  </Card>
</CardGrid>

## EIP References

- [EIP-155: Simple replay attack protection](https://eips.ethereum.org/EIPS/eip-155)
- [EIP-2718: Typed Transaction Envelope](https://eips.ethereum.org/EIPS/eip-2718)
- [EIP-2930: Optional access lists](https://eips.ethereum.org/EIPS/eip-2930)
- [EIP-1559: Fee market change](https://eips.ethereum.org/EIPS/eip-1559)
- [EIP-4844: Shard Blob Transactions](https://eips.ethereum.org/EIPS/eip-4844)
- [EIP-7702: Set EOA account code](https://eips.ethereum.org/EIPS/eip-7702)
