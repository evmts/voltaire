{
	"name": "engine_forkchoiceUpdatedV3",
	"summary": "Updates the forkchoice state",
	"externalDocs": {
		"description": "Method specification",
		"url": "https://github.com/ethereum/execution-apis/blob/main/src/engine/cancun.md#engine_forkchoiceupdatedv3"
	},
	"params": [
		{
			"name": "Forkchoice state",
			"required": true,
			"schema": {
				"title": "Forkchoice state object V1",
				"type": "object",
				"required": ["headBlockHash", "safeBlockHash", "finalizedBlockHash"],
				"properties": {
					"headBlockHash": {
						"title": "Head block hash",
						"type": "string",
						"pattern": "^0x[0-9a-f]{64}$"
					},
					"safeBlockHash": {
						"title": "Safe block hash",
						"type": "string",
						"pattern": "^0x[0-9a-f]{64}$"
					},
					"finalizedBlockHash": {
						"title": "Finalized block hash",
						"type": "string",
						"pattern": "^0x[0-9a-f]{64}$"
					}
				}
			}
		},
		{
			"name": "Payload attributes",
			"required": false,
			"schema": {
				"title": "Payload attributes object V3",
				"type": "object",
				"required": [
					"timestamp",
					"prevRandao",
					"suggestedFeeRecipient",
					"withdrawals",
					"parentBeaconBlockRoot"
				],
				"properties": {
					"timestamp": {
						"title": "Timestamp",
						"type": "string",
						"pattern": "^0x(0|[1-9a-f][0-9a-f]{0,15})$"
					},
					"prevRandao": {
						"title": "Previous randao value",
						"type": "string",
						"pattern": "^0x[0-9a-f]{64}$"
					},
					"suggestedFeeRecipient": {
						"title": "Suggested fee recipient",
						"type": "string",
						"pattern": "^0x[0-9a-fA-F]{40}$"
					},
					"withdrawals": {
						"title": "Withdrawals",
						"type": "array",
						"items": {
							"title": "Withdrawal object V1",
							"type": "object",
							"required": ["index", "validatorIndex", "address", "amount"],
							"properties": {
								"index": {
									"title": "Withdrawal index",
									"type": "string",
									"pattern": "^0x(0|[1-9a-f][0-9a-f]{0,15})$"
								},
								"validatorIndex": {
									"title": "Validator index",
									"type": "string",
									"pattern": "^0x(0|[1-9a-f][0-9a-f]{0,15})$"
								},
								"address": {
									"title": "Withdrawal address",
									"type": "string",
									"pattern": "^0x[0-9a-fA-F]{40}$"
								},
								"amount": {
									"title": "Withdrawal amount",
									"type": "string",
									"pattern": "^0x(0|[1-9a-f][0-9a-f]{0,15})$"
								}
							}
						}
					},
					"parentBeaconBlockRoot": {
						"title": "Parent beacon block root",
						"type": "string",
						"pattern": "^0x[0-9a-f]{64}$"
					}
				}
			}
		}
	],
	"result": {
		"name": "Response object",
		"schema": {
			"title": "Forkchoice updated response",
			"type": "object",
			"required": ["payloadStatus"],
			"properties": {
				"payloadStatus": {
					"title": "Payload status",
					"type": "object",
					"required": ["status"],
					"properties": {
						"status": {
							"title": "Payload validation status",
							"type": "string",
							"enum": ["VALID", "INVALID", "SYNCING"],
							"description": "Set of possible values is restricted to VALID, INVALID, SYNCING"
						},
						"latestValidHash": {
							"title": "The hash of the most recent valid block",
							"type": "string",
							"pattern": "^0x[0-9a-f]{64}$"
						},
						"validationError": {
							"title": "Validation error message",
							"type": "string"
						}
					}
				},
				"payloadId": {
					"title": "Payload id",
					"type": "string",
					"pattern": "^0x[0-9a-f]{16}$"
				}
			}
		}
	},
	"errors": [
		{ "code": -38002, "message": "Invalid forkchoice state" },
		{ "code": -38003, "message": "Invalid payload attributes" },
		{ "code": -32602, "message": "Invalid params" },
		{ "code": -38005, "message": "Unsupported fork" }
	],
	"examples": [
		{
			"name": "engine_forkchoiceUpdatedV3 example",
			"params": [
				{
					"name": "Forkchoice state",
					"value": {
						"headBlockHash": "0x3559e851470f6e7bbed1db474980683e8c315bfce99b2a6ef47c057c04de7858",
						"safeBlockHash": "0x3559e851470f6e7bbed1db474980683e8c315bfce99b2a6ef47c057c04de7858",
						"finalizedBlockHash": "0x3b8fb240d288781d4aac94d3fd16809ee413bc99294a085798a589dae51ddd4a"
					}
				},
				{
					"name": "Payload attributes",
					"value": {
						"timestamp": "0x64e7785b",
						"prevRandao": "0xc130d5e63c61c935f6089e61140ca9136172677cf6aa5800dcc1cf0a02152a14",
						"suggestedFeeRecipient": "0xa94f5374fce5edbc8e2a8697c15331677e6ebf0b",
						"withdrawals": [
							{
								"index": "0xf0",
								"validatorIndex": "0xf0",
								"address": "0x00000000000000000000000000000000000010f0",
								"amount": "0x1"
							},
							{
								"index": "0xf1",
								"validatorIndex": "0xf1",
								"address": "0x00000000000000000000000000000000000010f1",
								"amount": "0x1"
							}
						],
						"parentBeaconBlockRoot": "0x11f780a954bcba8889998e4e61deaae6388dd2391e9c810bd9c94962cc1eadc1"
					}
				}
			],
			"result": {
				"name": "Response object",
				"value": {
					"payloadStatus": {
						"status": "VALID",
						"latestValidHash": "0x3559e851470f6e7bbed1db474980683e8c315bfce99b2a6ef47c057c04de7858",
						"validationError": null
					},
					"payloadId": "0x0000000021f32cc1"
				}
			}
		}
	]
}
