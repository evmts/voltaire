---
title: '[Zig] src/crypto/kzg_trusted_setup.zig'
source: 'src/crypto/kzg_trusted_setup.zig'
---

> Auto-generated from Zig tests in: src/crypto/kzg_trusted_setup.zig

### trusted setup embedded

```zig
test "trusted setup embedded" {
    const testing = std.testing;

    // Verify data is embedded and non-empty
    try testing.expect(data.len > 0);

    // Should be approximately 788KB
    try testing.expect(data.len > 700_000);
    try testing.expect(data.len < 900_000);

    // Should start with the expected header format
    try testing.expect(std.mem.startsWith(u8, data, "4096\n65\n"));
}
```

### trusted setup SHA256 integrity verification

```zig
test "trusted setup SHA256 integrity verification" {
    // Verify the SHA256 hash matches the expected value
    try verifyIntegrity();
}
```

### trusted setup integrity check detects tampering

```zig
test "trusted setup integrity check detects tampering" {
    const testing = std.testing;

    // Create a modified copy of the data
    var tampered_data = std.ArrayList(u8).empty;
    defer tampered_data.deinit(testing.allocator);
    try tampered_data.appendSlice(testing.allocator, data);

    // Tamper with one byte
    if (tampered_data.items.len > 100) {
        tampered_data.items[100] ^= 0xFF;
    }

    // Compute hash of tampered data
    var hasher = std.crypto.hash.sha2.Sha256.init(.{});
    hasher.update(tampered_data.items);
    var tampered_hash: [32]u8 = undefined;
    hasher.final(&tampered_hash);

    // Verify the hash is different
    var hashes_differ = false;
    for (tampered_hash, EXPECTED_SHA256) |computed, expected| {
        if (computed != expected) {
            hashes_differ = true;
            break;
        }
    }
    try testing.expect(hashes_differ);
}
```

### trusted setup header parsing

```zig
test "trusted setup header parsing" {
    const testing = std.testing;

    const header = try parseHeader();
    try testing.expectEqual(@as(usize, EXPECTED_G1_POINTS), header.n_g1);
    try testing.expectEqual(@as(usize, EXPECTED_G2_POINTS), header.n_g2);
}
```

### trusted setup verification

```zig
test "trusted setup verification" {
    try verify();
}
```
