---
title: '[TS/JS] docs/primitives/gasconstants/index.test.ts'
source: 'docs/primitives/gasconstants/index.test.ts'
---

> Auto-generated from test file: docs/primitives/gasconstants/index.test.ts

```typescript
/**
 * Tests for docs/primitives/gasconstants/index.mdx
 *
 * Validates that all code examples in the GasConstants documentation work correctly.
 * GasConstants provides EVM gas cost constants and calculation functions.
 */
import { describe, expect, it } from "vitest";

describe("GasConstants Documentation - index.mdx", () => {
	describe("Calculation Functions", () => {
		it("should calculate call cost with calculateCallCost()", async () => {
			const { calculateCallCost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// API: calculateCallCost(isWarm, hasValue, isNewAccount, availableGas)
			// Returns { base, dynamic, stipend, forwarded, total }
			const result = calculateCallCost(false, true, false, 100000n);

			expect(result).toBeDefined();
			expect(typeof result.total).toBe("bigint");
			expect(result.total).toBeGreaterThan(0n);
		});

		it("should calculate copy cost with calculateCopyCost()", async () => {
			const { calculateCopyCost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// API: calculateCopyCost(size) - takes raw bigint
			const cost = calculateCopyCost(64n);

			expect(typeof cost).toBe("bigint");
			expect(cost).toBeGreaterThan(0n);
		});

		it("should calculate create cost with calculateCreateCost()", async () => {
			const { calculateCreateCost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// API: calculateCreateCost(initcodeSize, deployedSize)
			// Returns { base, dynamic, total }
			const result = calculateCreateCost(1000n, 500n);

			expect(result).toBeDefined();
			expect(typeof result.total).toBe("bigint");
			expect(result.total).toBeGreaterThan(0n);
		});

		it("should calculate keccak256 cost with calculateKeccak256Cost()", async () => {
			const { calculateKeccak256Cost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// API: calculateKeccak256Cost(dataSize) - takes raw bigint
			const cost = calculateKeccak256Cost(32n);

			expect(typeof cost).toBe("bigint");
			expect(cost).toBeGreaterThan(0n);
		});

		it("should calculate log cost with calculateLogCost()", async () => {
			const { calculateLogCost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// API: calculateLogCost(topicCount, dataSize) - takes raw bigints
			const cost = calculateLogCost(2n, 32n);

			expect(typeof cost).toBe("bigint");
			expect(cost).toBeGreaterThan(0n);
		});

		it("should calculate max refund with calculateMaxRefund()", async () => {
			const { calculateMaxRefund } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// API: calculateMaxRefund(gasUsed) - takes raw bigint
			const refund = calculateMaxRefund(100000n);

			expect(typeof refund).toBe("bigint");
			// Max refund is capped at 1/5 of gas used (post-London)
			expect(refund).toBeLessThanOrEqual(100000n / 5n);
		});

		it("should calculate memory expansion cost with calculateMemoryExpansionCost()", async () => {
			const { calculateMemoryExpansionCost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// API: calculateMemoryExpansionCost(oldSize, newSize)
			// Returns { oldCost, newCost, expansionCost, words }
			const result = calculateMemoryExpansionCost(0n, 64n);

			expect(result).toBeDefined();
			expect(typeof result.expansionCost).toBe("bigint");
			expect(result.expansionCost).toBeGreaterThanOrEqual(0n);
		});

		it("should calculate sstore cost with calculateSstoreCost()", async () => {
			const { calculateSstoreCost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// API: calculateSstoreCost(isWarm, currentValue, newValue)
			// Returns { cost, refund }
			const result = calculateSstoreCost(false, 0n, 1n);

			expect(result).toBeDefined();
			expect(typeof result.cost).toBe("bigint");
			expect(result.cost).toBeGreaterThan(0n);
		});

		it("should calculate transaction intrinsic gas with calculateTxIntrinsicGas()", async () => {
			const { calculateTxIntrinsicGas } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			const gas = calculateTxIntrinsicGas({
				dataSize: 100n,
				zeroBytes: 50n,
				isContractCreation: false,
				accessListAddresses: 0,
				accessListStorageKeys: 0,
			});

			expect(typeof gas).toBe("bigint");
			expect(gas).toBeGreaterThanOrEqual(21000n); // Base tx gas
		});
	});

	describe("Convenience Functions", () => {
		it("should have callCost() convenience function", async () => {
			const { callCost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			expect(typeof callCost).toBe("function");
		});

		it("should have copyCost() convenience function", async () => {
			const { copyCost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			expect(typeof copyCost).toBe("function");
		});

		it("should have createCost() convenience function", async () => {
			const { createCost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			expect(typeof createCost).toBe("function");
		});

		it("should have keccak256Cost() convenience function", async () => {
			const { keccak256Cost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			expect(typeof keccak256Cost).toBe("function");
		});

		it("should have logCost() convenience function", async () => {
			const { logCost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			expect(typeof logCost).toBe("function");
		});

		it("should have maxRefund() convenience function", async () => {
			const { maxRefund } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			expect(typeof maxRefund).toBe("function");
		});

		it("should have memoryExpansionCost() convenience function", async () => {
			const { memoryExpansionCost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			expect(typeof memoryExpansionCost).toBe("function");
		});

		it("should have sstoreCost() convenience function", async () => {
			const { sstoreCost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			expect(typeof sstoreCost).toBe("function");
		});

		it("should have txIntrinsicGas() convenience function", async () => {
			const { txIntrinsicGas } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			expect(typeof txIntrinsicGas).toBe("function");
		});
	});

	describe("EIP Check Functions", () => {
		it("should check EIP-1153 support with hasEIP1153()", async () => {
			const { hasEIP1153 } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// Cancun and later should support EIP-1153 (transient storage)
			expect(hasEIP1153("cancun")).toBe(true);
			expect(hasEIP1153("shanghai")).toBe(false);
		});

		it("should check EIP-2929 support with hasEIP2929()", async () => {
			const { hasEIP2929 } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// Berlin and later should support EIP-2929 (access lists gas)
			expect(hasEIP2929("berlin")).toBe(true);
			expect(hasEIP2929("istanbul")).toBe(false);
		});

		it("should check EIP-3529 support with hasEIP3529()", async () => {
			const { hasEIP3529 } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// London and later should support EIP-3529 (reduced refunds)
			expect(hasEIP3529("london")).toBe(true);
			expect(hasEIP3529("berlin")).toBe(false);
		});

		it("should check EIP-3860 support with hasEIP3860()", async () => {
			const { hasEIP3860 } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// Shanghai and later should support EIP-3860 (initcode metering)
			expect(hasEIP3860("shanghai")).toBe(true);
			expect(hasEIP3860("london")).toBe(false);
		});

		it("should check EIP-4844 support with hasEIP4844()", async () => {
			const { hasEIP4844 } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// Cancun and later should support EIP-4844 (blob transactions)
			expect(hasEIP4844("cancun")).toBe(true);
			expect(hasEIP4844("shanghai")).toBe(false);
		});
	});

	describe("Get Functions", () => {
		it("should get cold account access cost with getColdAccountAccessCost()", async () => {
			const { getColdAccountAccessCost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			const cost = getColdAccountAccessCost("berlin");
			expect(typeof cost).toBe("bigint");
			expect(cost).toBe(2600n); // EIP-2929 cold account access
		});

		it("should get cold sload cost with getColdSloadCost()", async () => {
			const { getColdSloadCost } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			const cost = getColdSloadCost("berlin");
			expect(typeof cost).toBe("bigint");
			expect(cost).toBe(2100n); // EIP-2929 cold SLOAD
		});

		it("should get selfdestruct refund with getSelfdestructRefund()", async () => {
			const { getSelfdestructRefund } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// Post-London, selfdestruct refund is 0
			const refund = getSelfdestructRefund("london");
			expect(typeof refund).toBe("bigint");
		});

		it("should get sstore refund with getSstoreRefund()", async () => {
			const { getSstoreRefund } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			const refund = getSstoreRefund("london");
			expect(typeof refund).toBe("bigint");
		});
	});

	describe("Constants", () => {
		it("should export gas constants", async () => {
			const constants = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			// Check for common gas constants
			expect(constants).toBeDefined();
		});
	});

	describe("Precompile Namespace", () => {
		it("should export Precompile namespace", async () => {
			const { Precompile } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			expect(Precompile).toBeDefined();
		});
	});

	describe("BrandedGasConstants Namespace", () => {
		it("should export BrandedGasConstants namespace with all functions", async () => {
			const { BrandedGasConstants } = await import(
				"../../../src/primitives/GasConstants/index.js"
			);

			expect(BrandedGasConstants).toBeDefined();
			expect(typeof BrandedGasConstants.calculateCallCost).toBe(
				"function",
			);
			expect(typeof BrandedGasConstants.calculateCopyCost).toBe(
				"function",
			);
			expect(typeof BrandedGasConstants.calculateCreateCost).toBe(
				"function",
			);
			expect(typeof BrandedGasConstants.calculateKeccak256Cost).toBe(
				"function",
			);
			expect(typeof BrandedGasConstants.calculateLogCost).toBe("function");
			expect(typeof BrandedGasConstants.calculateMaxRefund).toBe(
				"function",
			);
			expect(typeof BrandedGasConstants.calculateMemoryExpansionCost).toBe(
				"function",
			);
			expect(typeof BrandedGasConstants.calculateSstoreCost).toBe(
				"function",
			);
			expect(typeof BrandedGasConstants.calculateTxIntrinsicGas).toBe(
				"function",
			);
			expect(typeof BrandedGasConstants.hasEIP1153).toBe("function");
			expect(typeof BrandedGasConstants.hasEIP2929).toBe("function");
			expect(typeof BrandedGasConstants.hasEIP3529).toBe("function");
			expect(typeof BrandedGasConstants.hasEIP3860).toBe("function");
			expect(typeof BrandedGasConstants.hasEIP4844).toBe("function");
		});
	});
});

```
