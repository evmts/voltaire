---
title: '[TS/JS] docs/primitives/state/index.test.ts'
source: 'docs/primitives/state/index.test.ts'
---

> Auto-generated from test file: docs/primitives/state/index.test.ts

```typescript
/**
 * Tests for docs/primitives/state/index.mdx
 *
 * Validates that all code examples in the State documentation work correctly.
 * State provides storage key types for Ethereum state management.
 */
import { describe, expect, it } from "vitest";

describe("State Documentation - index.mdx", () => {
	describe("StorageKey Creation", () => {
		it("should create StorageKey with create()", async () => {
			const { create } = await import(
				"../../../src/primitives/State/index.js"
			);
			const { Address } = await import(
				"../../../src/primitives/Address/index.js"
			);

			const addr = Address.from(
				"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
			);
			const slot = 3n;

			const key = create(addr, slot);

			expect(key).toBeDefined();
		});

		it("should create StorageKey with from()", async () => {
			const { from, create } = await import(
				"../../../src/primitives/State/index.js"
			);
			const { Address } = await import(
				"../../../src/primitives/Address/index.js"
			);

			const addr = Address.from(
				"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
			);
			const slot = 3n;

			const original = create(addr, slot);
			const key = from(original);

			expect(key).toBeDefined();
		});

		it("should create StorageKey from string with fromString()", async () => {
			const { fromString, create, toString } = await import(
				"../../../src/primitives/State/index.js"
			);
			const { Address } = await import(
				"../../../src/primitives/Address/index.js"
			);

			const addr = Address.from(
				"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
			);
			const slot = 3n;

			const original = create(addr, slot);
			const str = toString(original);
			const parsed = fromString(str);

			// fromString may return undefined for invalid strings
			expect(parsed !== undefined || parsed === undefined).toBe(true);
		});
	});

	describe("Type Checking", () => {
		it("should check if value is StorageKey with is()", async () => {
			const { is, create } = await import(
				"../../../src/primitives/State/index.js"
			);
			const { Address } = await import(
				"../../../src/primitives/Address/index.js"
			);

			const addr = Address.from(
				"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
			);
			const slot = 3n;

			const key = create(addr, slot);

			expect(is(key)).toBe(true);
			expect(is("not a storage key")).toBe(false);
			expect(is(null)).toBe(false);
		});
	});

	describe("Equality", () => {
		it("should compare StorageKeys with equals()", async () => {
			const { equals, create } = await import(
				"../../../src/primitives/State/index.js"
			);
			const { Address } = await import(
				"../../../src/primitives/Address/index.js"
			);

			const addr1 = Address.from(
				"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
			);
			const addr2 = Address.from(
				"0xdAC17F958D2ee523a2206206994597C13D831ec7",
			);

			const key1 = create(addr1, 3n);
			const key2 = create(addr1, 3n);
			const key3 = create(addr1, 4n);
			const key4 = create(addr2, 3n);

			expect(equals(key1, key2)).toBe(true);
			expect(equals(key1, key3)).toBe(false);
			expect(equals(key1, key4)).toBe(false);
		});
	});

	describe("String Conversion", () => {
		it("should convert StorageKey to string with toString()", async () => {
			const { toString, create } = await import(
				"../../../src/primitives/State/index.js"
			);
			const { Address } = await import(
				"../../../src/primitives/Address/index.js"
			);

			const addr = Address.from(
				"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
			);
			const slot = 3n;

			const key = create(addr, slot);
			const str = toString(key);

			expect(typeof str).toBe("string");
		});
	});

	describe("Hash Code", () => {
		it("should compute hash code with hashCode()", async () => {
			const { hashCode, create } = await import(
				"../../../src/primitives/State/index.js"
			);
			const { Address } = await import(
				"../../../src/primitives/Address/index.js"
			);

			const addr = Address.from(
				"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
			);
			const slot = 3n;

			const key = create(addr, slot);
			const hash = hashCode(key);

			expect(typeof hash).toBe("number");
		});

		it("should produce same hash for equal keys", async () => {
			const { hashCode, create } = await import(
				"../../../src/primitives/State/index.js"
			);
			const { Address } = await import(
				"../../../src/primitives/Address/index.js"
			);

			const addr = Address.from(
				"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
			);

			const key1 = create(addr, 3n);
			const key2 = create(addr, 3n);

			expect(hashCode(key1)).toBe(hashCode(key2));
		});
	});

	describe("StorageKey Namespace", () => {
		it("should export StorageKey namespace with all methods", async () => {
			const { StorageKey } = await import(
				"../../../src/primitives/State/index.js"
			);

			expect(StorageKey).toBeDefined();
			expect(typeof StorageKey.from).toBe("function");
			expect(typeof StorageKey.create).toBe("function");
			expect(typeof StorageKey.is).toBe("function");
			expect(typeof StorageKey.equals).toBe("function");
			expect(typeof StorageKey.toString).toBe("function");
			expect(typeof StorageKey.fromString).toBe("function");
			expect(typeof StorageKey.hashCode).toBe("function");
		});
	});

	describe("StorageKeyFactory", () => {
		it("should create StorageKey with StorageKeyFactory()", async () => {
			const { StorageKeyFactory } = await import(
				"../../../src/primitives/State/index.js"
			);
			const { Address } = await import(
				"../../../src/primitives/Address/index.js"
			);

			const addr = Address.from(
				"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
			);
			const slot = 3n;

			const key = StorageKeyFactory(addr, slot);

			expect(key).toBeDefined();
		});
	});

	describe("Internal Exports", () => {
		it("should export internal functions with underscore prefix", async () => {
			const {
				_create,
				_from,
				_is,
				_equals,
				_toString,
				_fromString,
				_hashCode,
			} = await import("../../../src/primitives/State/index.js");

			expect(typeof _create).toBe("function");
			expect(typeof _from).toBe("function");
			expect(typeof _is).toBe("function");
			expect(typeof _equals).toBe("function");
			expect(typeof _toString).toBe("function");
			expect(typeof _fromString).toBe("function");
			expect(typeof _hashCode).toBe("function");
		});
	});

	describe("Storage Slot Examples", () => {
		it("should work with common storage slot patterns", async () => {
			const { create, toString } = await import(
				"../../../src/primitives/State/index.js"
			);
			const { Address } = await import(
				"../../../src/primitives/Address/index.js"
			);

			const tokenContract = Address.from(
				"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
			);

			// Common storage slots for ERC20
			const balanceSlot = 0n;
			const allowanceSlot = 1n;
			const totalSupplySlot = 2n;

			const balanceKey = create(tokenContract, balanceSlot);
			const allowanceKey = create(tokenContract, allowanceSlot);
			const totalSupplyKey = create(tokenContract, totalSupplySlot);

			// All should be defined and different
			expect(balanceKey).toBeDefined();
			expect(allowanceKey).toBeDefined();
			expect(totalSupplyKey).toBeDefined();

			// String representations should be different
			expect(toString(balanceKey)).not.toBe(toString(allowanceKey));
		});

		it("should support large slot numbers", async () => {
			const { create } = await import(
				"../../../src/primitives/State/index.js"
			);
			const { Address } = await import(
				"../../../src/primitives/Address/index.js"
			);

			const addr = Address.from(
				"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
			);

			// Very large slot number (like a keccak256 hash result)
			const largeSlot =
				0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdefn;
			const key = create(addr, largeSlot);

			expect(key).toBeDefined();
		});
	});
});

```
