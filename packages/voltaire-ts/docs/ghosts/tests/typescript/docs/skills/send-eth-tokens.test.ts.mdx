---
title: '[TS/JS] docs/skills/send-eth-tokens.test.ts'
source: 'docs/skills/send-eth-tokens.test.ts'
---

> Auto-generated from test file: docs/skills/send-eth-tokens.test.ts

```typescript
/**
 * Tests for send ETH & tokens guide
 * @see /docs/guides/send-eth-tokens.mdx
 *
 * Note: The guide mostly covers Provider/Contract interactions which require network access.
 * These tests cover the primitives and transaction building that ARE available.
 *
 * API DISCREPANCIES:
 * - '@voltaire/provider' doesn't exist as an export
 * - '@voltaire/contract' doesn't exist as an export
 * - Transaction module is available at src/primitives/Transaction/
 * - Denomination helpers are available at src/primitives/Denomination/
 */
import { describe, expect, it } from "vitest";

describe("Send ETH & Tokens Guide", () => {
	it("should work with Address primitive", async () => {
		const { Address } = await import("../../src/primitives/Address/index.js");

		const addr = Address("0x5FbDB2315678afecb367f032d93F642f64180aa3");
		// toHex returns lowercase
		expect(Address.toHex(addr).toLowerCase()).toBe(
			"0x5fbdb2315678afecb367f032d93f642f64180aa3",
		);
	});

	it("should convert hex value to bigint (1 ETH)", () => {
		// From guide: value: '0xDE0B6B3A7640000' // 1 ETH in hex
		const hexValue = "0xDE0B6B3A7640000";
		const weiValue = BigInt(hexValue);

		expect(weiValue).toBe(1_000_000_000_000_000_000n);
	});

	it("should work with Denomination helpers", async () => {
		// Note: Guide references @voltaire/primitives/Denomination/Ether and Gwei
		// Check if they exist in the codebase
		const Denomination = await import(
			"../../src/primitives/Denomination/index.js"
		);

		// Denomination module should exist
		expect(Denomination).toBeDefined();
	});

	it("should build EIP-1559 transaction structure", async () => {
		const { Address } = await import("../../src/primitives/Address/index.js");

		// Transaction structure from guide
		const tx = {
			type: 2, // EIP-1559
			chainId: 1n,
			nonce: 0n,
			maxPriorityFeePerGas: 1_000_000_000n, // 1 Gwei
			maxFeePerGas: 50_000_000_000n, // 50 Gwei
			gasLimit: 21_000n, // Standard ETH transfer
			to: Address("0x5FbDB2315678afecb367f032d93F642f64180aa3"),
			value: 1_000_000_000_000_000_000n, // 1 ETH in wei
			data: new Uint8Array(),
			accessList: [],
		};

		expect(tx.type).toBe(2);
		expect(tx.gasLimit).toBe(21000n);
		expect(tx.value).toBe(1_000_000_000_000_000_000n);
	});

	it("should build legacy transaction structure", async () => {
		const { Address } = await import("../../src/primitives/Address/index.js");

		// Legacy transaction from guide
		const legacyTx = {
			type: 0, // Legacy
			nonce: 0n,
			gasPrice: 50_000_000_000n,
			gasLimit: 21_000n,
			to: Address("0x5FbDB2315678afecb367f032d93F642f64180aa3"),
			value: 1_000_000_000_000_000_000n,
			data: new Uint8Array(),
		};

		expect(legacyTx.type).toBe(0);
		expect(legacyTx.gasPrice).toBe(50_000_000_000n);
	});

	it("should calculate gas with 20% buffer", () => {
		// From guide: const gasLimit = gasEstimate * 120n / 100n;
		const gasEstimate = 65000n; // Token transfers typically use ~65k gas
		const gasWithBuffer = (gasEstimate * 120n) / 100n;

		expect(gasWithBuffer).toBe(78000n);
	});

	it("should parse transaction receipt status", () => {
		// From guide: receipt.status === '0x1' means success
		const successStatus = "0x1";
		const revertedStatus = "0x0";

		expect(successStatus === "0x1").toBe(true);
		expect(revertedStatus === "0x1").toBe(false);
	});

	it("should calculate confirmations", () => {
		// From guide: confirmations = currentBlock - txBlock + 1
		const txBlockNumber = 19_000_000n;
		const currentBlockNumber = 19_000_003n;

		const confirmations = currentBlockNumber - txBlockNumber + 1n;

		expect(confirmations).toBe(4n);
	});

	it("should work with Hex primitive for encoding", async () => {
		const { Hex } = await import("../../src/primitives/Hex/index.js");

		// Convert bytes to hex for RPC
		const bytes = new Uint8Array([0xde, 0xad, 0xbe, 0xef]);
		const hexStr = Hex.fromBytes(bytes);

		expect(hexStr).toBe("0xdeadbeef");
	});

	it("should serialize bytes to hex string manually", () => {
		// From guide: manual hex conversion
		const serialized = new Uint8Array([0x02, 0xf8, 0x50]);
		const hexTx =
			"0x" +
			Array.from(serialized)
				.map((b) => b.toString(16).padStart(2, "0"))
				.join("");

		expect(hexTx).toBe("0x02f850");
	});

	it("should work with ERC-20 ABI structure", () => {
		// ERC-20 transfer ABI from guide
		const erc20Abi = [
			{
				type: "function",
				name: "transfer",
				stateMutability: "nonpayable",
				inputs: [
					{ type: "address", name: "to" },
					{ type: "uint256", name: "amount" },
				],
				outputs: [{ type: "bool", name: "" }],
			},
			{
				type: "function",
				name: "balanceOf",
				stateMutability: "view",
				inputs: [{ type: "address", name: "account" }],
				outputs: [{ type: "uint256", name: "" }],
			},
		] as const;

		expect(erc20Abi[0].name).toBe("transfer");
		expect(erc20Abi[1].name).toBe("balanceOf");
	});

	it("should handle token decimals", () => {
		// From guide: 100 USDC (6 decimals)
		const amount = 100_000_000n; // 100 USDC
		const decimals = 6n;

		const humanReadable = Number(amount) / 10 ** Number(decimals);
		expect(humanReadable).toBe(100);

		// Convert back
		const rawAmount = BigInt(Math.floor(100 * 10 ** Number(decimals)));
		expect(rawAmount).toBe(100_000_000n);
	});
});

```
