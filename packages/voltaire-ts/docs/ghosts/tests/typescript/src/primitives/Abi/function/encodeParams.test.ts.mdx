---
title: '[TS/JS] src/primitives/Abi/function/encodeParams.test.ts'
source: 'src/primitives/Abi/function/encodeParams.test.ts'
---

> Auto-generated from test file: src/primitives/Abi/function/encodeParams.test.ts

```typescript
/**
 * Unit tests for encodeParams function
 */

import { describe, expect, it } from "vitest";
import { encodeParams } from "./encodeParams.js";

describe("encodeParams", () => {
	describe("basic encoding", () => {
		it("encodes function with no parameters", () => {
			const func = {
				type: "function",
				name: "test",
				stateMutability: "nonpayable",
				inputs: [],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, []);
			expect(encoded).toBeInstanceOf(Uint8Array);
			expect(encoded.length).toBe(4); // Just selector
		});

		it("encodes function with single uint256 parameter", () => {
			const func = {
				type: "function",
				name: "setValue",
				stateMutability: "nonpayable",
				inputs: [{ type: "uint256", name: "value" }],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, [100n]);
			expect(encoded).toBeInstanceOf(Uint8Array);
			expect(encoded.length).toBeGreaterThan(4);
		});

		it("encodes function with multiple parameters", () => {
			const func = {
				type: "function",
				name: "transfer",
				stateMutability: "nonpayable",
				inputs: [
					{ type: "address", name: "to" },
					{ type: "uint256", name: "amount" },
				],
				outputs: [{ type: "bool", name: "" }],
			} as const;

			const encoded = encodeParams(func, [
				"0x742d35Cc6634C0532925a3b844Bc9e7595f251e3",
				100n,
			]);
			expect(encoded).toBeInstanceOf(Uint8Array);
			expect(encoded.length).toBeGreaterThan(4);
		});
	});

	describe("selector inclusion", () => {
		it("includes correct selector at start", () => {
			const func = {
				type: "function",
				name: "transfer",
				stateMutability: "nonpayable",
				inputs: [
					{ type: "address", name: "to" },
					{ type: "uint256", name: "amount" },
				],
				outputs: [{ type: "bool", name: "" }],
			} as const;

			const encoded = encodeParams(func, [
				"0x742d35Cc6634C0532925a3b844Bc9e7595f251e3",
				100n,
			]);

			// transfer(address,uint256) selector = 0xa9059cbb
			expect(encoded[0]).toBe(0xa9);
			expect(encoded[1]).toBe(0x05);
			expect(encoded[2]).toBe(0x9c);
			expect(encoded[3]).toBe(0xbb);
		});

		it("includes selector for function with no parameters", () => {
			const func = {
				type: "function",
				name: "deposit",
				stateMutability: "payable",
				inputs: [],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, []);
			expect(encoded.length).toBe(4);
			expect(encoded).toBeInstanceOf(Uint8Array);
		});
	});

	describe("parameter encoding", () => {
		it("encodes address parameter", () => {
			const func = {
				type: "function",
				name: "setAddress",
				stateMutability: "nonpayable",
				inputs: [{ type: "address", name: "addr" }],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, [
				"0x742d35Cc6634C0532925a3b844Bc9e7595f251e3",
			]);
			expect(encoded.length).toBe(4 + 32); // selector + 1 word
		});

		it("encodes bool parameter", () => {
			const func = {
				type: "function",
				name: "setFlag",
				stateMutability: "nonpayable",
				inputs: [{ type: "bool", name: "flag" }],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, [true]);
			expect(encoded.length).toBe(4 + 32);
		});

		it("encodes bytes32 parameter", () => {
			const func = {
				type: "function",
				name: "setHash",
				stateMutability: "nonpayable",
				inputs: [{ type: "bytes32", name: "hash" }],
				outputs: [],
			} as const;

			const hash = new Uint8Array(32);
			hash[0] = 0xaa;
			const encoded = encodeParams(func, [hash]);
			expect(encoded.length).toBe(4 + 32);
		});

		it("encodes string parameter", () => {
			const func = {
				type: "function",
				name: "setName",
				stateMutability: "nonpayable",
				inputs: [{ type: "string", name: "name" }],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, ["hello"]);
			expect(encoded.length).toBeGreaterThan(4);
		});

		it("encodes bytes parameter", () => {
			const func = {
				type: "function",
				name: "setData",
				stateMutability: "nonpayable",
				inputs: [{ type: "bytes", name: "data" }],
				outputs: [],
			} as const;

			const data = new Uint8Array([1, 2, 3, 4]);
			const encoded = encodeParams(func, [data]);
			expect(encoded.length).toBeGreaterThan(4);
		});
	});

	describe("array parameters", () => {
		it("encodes fixed-size array", () => {
			const func = {
				type: "function",
				name: "setArray",
				stateMutability: "nonpayable",
				inputs: [{ type: "uint256[3]", name: "values" }],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, [[1n, 2n, 3n]]);
			expect(encoded.length).toBeGreaterThan(4);
		});

		it("encodes dynamic array", () => {
			const func = {
				type: "function",
				name: "setDynamicArray",
				stateMutability: "nonpayable",
				inputs: [{ type: "uint256[]", name: "values" }],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, [[1n, 2n, 3n, 4n]]);
			expect(encoded.length).toBeGreaterThan(4);
		});

		it("encodes empty dynamic array", () => {
			const func = {
				type: "function",
				name: "setDynamicArray",
				stateMutability: "nonpayable",
				inputs: [{ type: "uint256[]", name: "values" }],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, [[]]);
			expect(encoded.length).toBeGreaterThan(4);
		});
	});

	describe("tuple parameters", () => {
		it("encodes simple tuple", () => {
			const func = {
				type: "function",
				name: "setData",
				stateMutability: "nonpayable",
				inputs: [
					{
						type: "tuple",
						name: "data",
						components: [
							{ type: "address", name: "addr" },
							{ type: "uint256", name: "value" },
						],
					},
				],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, [
				["0x742d35Cc6634C0532925a3b844Bc9e7595f251e3", 100n],
			]);
			expect(encoded.length).toBeGreaterThan(4);
		});

		it("encodes tuple array", () => {
			const func = {
				type: "function",
				name: "setTuples",
				stateMutability: "nonpayable",
				inputs: [
					{
						type: "tuple[]",
						name: "items",
						components: [
							{ type: "address", name: "addr" },
							{ type: "uint256", name: "value" },
						],
					},
				],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, [
				[
					["0x742d35Cc6634C0532925a3b844Bc9e7595f251e3", 100n],
					["0x742d35Cc6634C0532925a3b844Bc9e7595f251e3", 200n],
				],
			]);
			expect(encoded.length).toBeGreaterThan(4);
		});
	});

	describe("multiple parameters", () => {
		it("encodes multiple parameters in order", () => {
			const func = {
				type: "function",
				name: "complexFunction",
				stateMutability: "nonpayable",
				inputs: [
					{ type: "address", name: "addr" },
					{ type: "uint256", name: "amount" },
					{ type: "bool", name: "flag" },
				],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, [
				"0x742d35Cc6634C0532925a3b844Bc9e7595f251e3",
				100n,
				true,
			]);
			expect(encoded.length).toBeGreaterThan(4);
		});

		it("encodes mix of static and dynamic parameters", () => {
			const func = {
				type: "function",
				name: "mixedFunction",
				stateMutability: "nonpayable",
				inputs: [
					{ type: "uint256", name: "value" },
					{ type: "string", name: "text" },
					{ type: "bool", name: "flag" },
				],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, [42n, "hello", true]);
			expect(encoded.length).toBeGreaterThan(4);
		});
	});

	describe("edge cases", () => {
		it("encodes zero values", () => {
			const func = {
				type: "function",
				name: "setZero",
				stateMutability: "nonpayable",
				inputs: [{ type: "uint256", name: "value" }],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, [0n]);
			expect(encoded.length).toBe(4 + 32);
		});

		it("encodes max uint256", () => {
			const func = {
				type: "function",
				name: "setMax",
				stateMutability: "nonpayable",
				inputs: [{ type: "uint256", name: "value" }],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, [
				0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffn,
			]);
			expect(encoded.length).toBe(4 + 32);
		});

		it("encodes empty string", () => {
			const func = {
				type: "function",
				name: "setString",
				stateMutability: "nonpayable",
				inputs: [{ type: "string", name: "text" }],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, [""]);
			expect(encoded.length).toBeGreaterThan(4);
		});

		it("encodes empty bytes", () => {
			const func = {
				type: "function",
				name: "setBytes",
				stateMutability: "nonpayable",
				inputs: [{ type: "bytes", name: "data" }],
				outputs: [],
			} as const;

			const encoded = encodeParams(func, [new Uint8Array(0)]);
			expect(encoded.length).toBeGreaterThan(4);
		});
	});

	describe("real-world examples", () => {
		it("encodes ERC20 transfer", () => {
			const func = {
				type: "function",
				name: "transfer",
				stateMutability: "nonpayable",
				inputs: [
					{ type: "address", name: "recipient" },
					{ type: "uint256", name: "amount" },
				],
				outputs: [{ type: "bool", name: "" }],
			} as const;

			const encoded = encodeParams(func, [
				"0x742d35Cc6634C0532925a3b844Bc9e7595f251e3",
				1000000000000000000n,
			]);

			expect(encoded.length).toBe(4 + 64); // selector + 2 words
			expect(encoded[0]).toBe(0xa9); // transfer selector
		});

		it("encodes ERC20 approve", () => {
			const func = {
				type: "function",
				name: "approve",
				stateMutability: "nonpayable",
				inputs: [
					{ type: "address", name: "spender" },
					{ type: "uint256", name: "amount" },
				],
				outputs: [{ type: "bool", name: "" }],
			} as const;

			const encoded = encodeParams(func, [
				"0x742d35Cc6634C0532925a3b844Bc9e7595f251e3",
				1000000000000000000n,
			]);

			expect(encoded.length).toBe(4 + 64);
			expect(encoded[0]).toBe(0x09); // approve selector
		});
	});
});

```
