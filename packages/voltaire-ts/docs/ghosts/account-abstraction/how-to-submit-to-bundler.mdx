---
title: How to Submit UserOperation to Bundler
description: Send signed UserOperations to an ERC-4337 bundler for inclusion.
---

## Overview

Bundlers are specialized nodes that:
1. Receive UserOperations via RPC
2. Simulate and validate operations
3. Bundle multiple UserOps into a single transaction
4. Submit to EntryPoint contract on-chain

## Bundler RPC Methods

| Method | Description |
|--------|-------------|
| `eth_sendUserOperation` | Submit UserOp to mempool |
| `eth_estimateUserOperationGas` | Estimate gas limits |
| `eth_getUserOperationByHash` | Get UserOp by hash |
| `eth_getUserOperationReceipt` | Get execution receipt |
| `eth_supportedEntryPoints` | List supported EntryPoints |

## Submitting a UserOperation

```typescript
import { UserOperation } from '@tevm/voltaire/primitives/UserOperation';
import { ENTRYPOINT_V06 } from '@tevm/voltaire/primitives/EntryPoint';

// Assume signedUserOp is complete with valid signature
const userOpHash = await bundlerClient.request({
  method: 'eth_sendUserOperation',
  params: [signedUserOp, ENTRYPOINT_V06],
});

console.log('Submitted:', userOpHash);
// Returns userOpHash (bytes32) for tracking
```

## Bundler Client Setup

```typescript
// Direct RPC client
const bundlerClient = {
  request: async ({ method, params }) => {
    const response = await fetch(bundlerRpcUrl, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        jsonrpc: '2.0',
        id: 1,
        method,
        params,
      }),
    });
    const { result, error } = await response.json();
    if (error) throw new Error(error.message);
    return result;
  },
};
```

## Popular Bundler Endpoints

| Provider | Endpoint Pattern |
|----------|------------------|
| Alchemy | `https://eth-mainnet.g.alchemy.com/v2/{key}` |
| Pimlico | `https://api.pimlico.io/v2/{chain}/rpc?apikey={key}` |
| Stackup | `https://api.stackup.sh/v1/node/{key}` |
| Biconomy | `https://bundler.biconomy.io/api/v2/{chainId}/{key}` |

## Tracking UserOperation Status

```typescript
// Poll for receipt
async function waitForUserOp(userOpHash, timeout = 60000) {
  const start = Date.now();

  while (Date.now() - start < timeout) {
    const receipt = await bundlerClient.request({
      method: 'eth_getUserOperationReceipt',
      params: [userOpHash],
    });

    if (receipt) {
      return receipt;
    }

    await new Promise(r => setTimeout(r, 2000));
  }

  throw new Error('UserOperation timed out');
}

const receipt = await waitForUserOp(userOpHash);
console.log('Tx hash:', receipt.receipt.transactionHash);
console.log('Success:', receipt.success);
```

## Receipt Structure

```typescript
interface UserOperationReceipt {
  userOpHash: string;
  entryPoint: string;
  sender: string;
  nonce: string;
  paymaster: string;
  actualGasCost: string;
  actualGasUsed: string;
  success: boolean;
  logs: Log[];
  receipt: TransactionReceipt;
}
```

## Error Handling

Common bundler rejection reasons:

```typescript
try {
  await bundlerClient.request({
    method: 'eth_sendUserOperation',
    params: [userOp, entryPoint],
  });
} catch (error) {
  // AA10: sender already constructed
  // AA21: didn't pay prefund
  // AA23: reverted (or OOG) during verification
  // AA24: signature error
  // AA25: invalid account nonce
  // AA31: paymaster deposit too low
  // AA33: reverted during postOp
  // AA40: over verification gas limit
  // AA41: over paymaster verification gas
  // AA51: prefund below actualGasCost

  console.error('Bundler rejected:', error.message);
}
```

## Checking Supported EntryPoints

```typescript
const entryPoints = await bundlerClient.request({
  method: 'eth_supportedEntryPoints',
  params: [],
});

// Returns array: ["0x5FF137D4b0FDCD49DcA30c7CF57E578a026d2789", ...]
```

## Preflight Validation

Simulate before submission:

```typescript
// Some bundlers support eth_callUserOperation
const simulationResult = await bundlerClient.request({
  method: 'eth_callUserOperation',
  params: [userOp, entryPoint, 'latest'],
});

if (!simulationResult.success) {
  console.error('Simulation failed:', simulationResult.error);
}
```

## Related

- [Create UserOperation](/ghosts/account-abstraction/how-to-create-useroperation)
- [Estimate UserOperation Gas](/ghosts/account-abstraction/how-to-estimate-userop-gas)
- [Sign UserOperation](/ghosts/account-abstraction/how-to-sign-useroperation)
- [Bundler Reference](/primitives/bundler)
- [EntryPoint Reference](/primitives/entry-point)
