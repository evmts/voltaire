---
title: Recover Signer Address from Signature
description: Use ecRecover to derive the signer address from a signature and message hash
---

## Goal

Given a signature (r, s, v) and message hash, recover the signer's Ethereum address.

## Code

```typescript
import * as Secp256k1 from '@voltaire/crypto/Secp256k1';
import * as Keccak256 from '@voltaire/crypto/Keccak256';
import * as Address from '@voltaire/primitives/Address';

// Your signature components
const signature = {
  r: rBytes,     // 32 bytes
  s: sBytes,     // 32 bytes
  v: 27          // 27 or 28
};

// Message hash that was signed
const messageHash = Keccak256.hash(messageBytes);

// Recover public key
const publicKey = Secp256k1.recoverPublicKey(signature, messageHash);

// Derive address from public key (last 20 bytes of keccak256(pubkey))
const addressHash = Keccak256.hash(publicKey);
const signerAddress = Address.from(addressHash.slice(12));

console.log(Address.toChecksummed(signerAddress));
```

## EIP-191 Personal Sign

```typescript
// Recover from personal_sign (eth_sign)
const message = 'Sign this message';
const prefix = `\x19Ethereum Signed Message:\n${message.length}`;
const prefixedMessage = new TextEncoder().encode(prefix + message);
const messageHash = Keccak256.hash(prefixedMessage);

const publicKey = Secp256k1.recoverPublicKey(signature, messageHash);
const addressHash = Keccak256.hash(publicKey);
const signerAddress = Address.from(addressHash.slice(12));
```

## EIP-712 Typed Data

```typescript
import * as EIP712 from '@voltaire/crypto/EIP712';

// Recover from typed data signature
const signerAddress = EIP712.recoverAddress(signature, typedData);
```

## Verify Expected Signer

```typescript
function verifySigner(
  signature: { r: Uint8Array; s: Uint8Array; v: number },
  messageHash: Uint8Array,
  expectedAddress: string
): boolean {
  const publicKey = Secp256k1.recoverPublicKey(signature, messageHash);
  const addressHash = Keccak256.hash(publicKey);
  const recovered = Address.toChecksummed(Address.from(addressHash.slice(12)));
  return recovered.toLowerCase() === expectedAddress.toLowerCase();
}
```
