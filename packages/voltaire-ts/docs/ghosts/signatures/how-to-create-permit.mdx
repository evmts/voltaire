---
title: Create a Permit Signature (ERC-2612)
description: Sign gasless ERC-20 approvals using EIP-712 typed data
---

## Goal

Create an ERC-2612 permit signature for gasless token approvals.

## Code

```typescript
import * as EIP712 from '@voltaire/crypto/EIP712';
import * as Address from '@voltaire/primitives/Address';

// Token contract domain
const domain = {
  name: 'USD Coin',           // Token name
  version: '1',               // Usually '1' or '2'
  chainId: 1n,                // Mainnet
  verifyingContract: Address.from('0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48') // USDC
};

// ERC-2612 Permit types
const types = {
  Permit: [
    { name: 'owner', type: 'address' },
    { name: 'spender', type: 'address' },
    { name: 'value', type: 'uint256' },
    { name: 'nonce', type: 'uint256' },
    { name: 'deadline', type: 'uint256' }
  ]
};

// Permit message
const message = {
  owner: Address.from(ownerAddress),
  spender: Address.from(spenderAddress),
  value: 1000000n,                              // 1 USDC (6 decimals)
  nonce: 0n,                                    // Get from token.nonces(owner)
  deadline: BigInt(Math.floor(Date.now() / 1000) + 3600) // 1 hour
};

// Create typed data
const typedData = {
  domain,
  types,
  primaryType: 'Permit',
  message
};

// Sign permit
const signature = EIP712.signTypedData(typedData, privateKey);

// Extract r, s, v for contract call
const { r, s, v } = signature;
```

## Submit to Contract

```typescript
// Call permit() on the token contract
await tokenContract.permit(
  message.owner,
  message.spender,
  message.value,
  message.deadline,
  v,
  r,
  s
);
```

## Permit2 (Uniswap)

```typescript
// Uniswap Permit2 uses different types
const permit2Types = {
  PermitSingle: [
    { name: 'details', type: 'PermitDetails' },
    { name: 'spender', type: 'address' },
    { name: 'sigDeadline', type: 'uint256' }
  ],
  PermitDetails: [
    { name: 'token', type: 'address' },
    { name: 'amount', type: 'uint160' },
    { name: 'expiration', type: 'uint48' },
    { name: 'nonce', type: 'uint48' }
  ]
};

const permit2Domain = {
  name: 'Permit2',
  chainId: 1n,
  verifyingContract: Address.from('0x000000000022D473030F116dDEE9F6B43aC78BA3')
};
```

## Get Nonce

```typescript
// Query current nonce from token contract
const nonce = await tokenContract.nonces(ownerAddress);
```
