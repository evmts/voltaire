---
title: BLS12-381 Pairing (0x11)
description: BLS12-381 elliptic curve pairing check precompile
---

# BLS12-381 Pairing

BLS12-381 bilinear pairing check for BLS signature verification.

## Overview

The BLS12-381 Pairing precompile provides:
- **Pairing Check**: Verify e(P₁,Q₁) * e(P₂,Q₂) * ... = 1
- **BLS Signatures**: Core operation for BLS signature verification
- **Variable Gas**: Cost scales with number of point pairs
- **C Library**: Uses blst for performance
- **Address**: 0x0000000000000000000000000000000000000011
- **Since**: Prague (EIP-2537)

**Source**: `src/precompiles/bls12_pairing.zig`

## Key Functions

### execute

```zig
const precompiles = @import("precompiles");

pub fn execute(
    allocator: std.mem.Allocator,
    input: []const u8,
    gas_limit: u64,
) PrecompileError!PrecompileResult
```

**Parameters:**
- `allocator`: Memory allocator for result
- `input`: Multiple of 384 bytes (k pairs of G1 + G2 points)
- `gas_limit`: Maximum gas available

**Input Format** (384k bytes for k pairs):
Each pair (384 bytes):
- Bytes 0-127: G1 point (128 bytes)
- Bytes 128-383: G2 point (256 bytes)

**Returns:** 32 bytes (1 if pairing holds, 0 otherwise)

**Errors:** `OutOfGas`, `InvalidInput`, `InvalidPairing`

## Gas Costs

**Formula:** `65000 + 43000 * k`

Where k = number of point pairs

- **Base Cost:** 65000 gas
- **Per Pair:** 43000 gas

**Examples:**
- 0 pairs (empty): 65000 gas (returns 1)
- 1 pair: 108000 gas
- 2 pairs: 151000 gas

## BLS Signature Verification

Verifies: e(signature, G2_generator) = e(hash_to_curve(message), pubkey)

Rearranged as pairing check:
e(signature, G2_generator) * e(-hash_to_curve(message), pubkey) = 1

## Performance

**Native (ReleaseFast):**
- 1 pair: ~5-10 ms
- 2 pairs: ~10-20 ms

**WASM (ReleaseFast)**: Not supported (uses C library)

## Testing

```bash
zig build test -Dtest-filter=bls12_pairing
```

## Related

- [BLS12-381 G1 Add](/zig/precompiles/bls12_g1_add/) - G1 addition (0x0B)
- [BLS12-381 G2 Add](/zig/precompiles/bls12_g2_add/) - G2 addition (0x0E)
- [BN254 Pairing](/zig/precompiles/bn254_pairing/) - BN254 pairing (0x08)

## References

- [EIP-2537](https://eips.ethereum.org/EIPS/eip-2537) - Precompile for BLS12-381 curve operations
- [BLS Signatures](https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bls-signature) - IETF draft
