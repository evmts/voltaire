---
title: Chain Service
description: Blockchain network configuration with Effect.ts
---

## Quick Start

```typescript
import { Effect } from 'effect'
import { ChainService, mainnet } from 'voltaire-effect/services'

const program = Effect.gen(function* () {
  const chain = yield* ChainService
  console.log(`Connected to ${chain.name} (${chain.id})`)
  return chain
}).pipe(Effect.provide(mainnet))
```

## Predefined Chains

voltaire-effect provides Layer configurations for common networks:

```typescript
import { mainnet, sepolia, optimism, arbitrum, base, polygon } from 'voltaire-effect/services'

// Ethereum Mainnet (id: 1)
Effect.provide(mainnet)

// Sepolia Testnet (id: 11155111)
Effect.provide(sepolia)

// Optimism (id: 10)
Effect.provide(optimism)

// Arbitrum One (id: 42161)
Effect.provide(arbitrum)

// Base (id: 8453)
Effect.provide(base)

// Polygon (id: 137)
Effect.provide(polygon)
```

## ChainConfig Interface

```typescript
interface ChainConfig {
  readonly id: number                    // Chain ID
  readonly name: string                  // Human-readable name
  readonly nativeCurrency: {
    readonly name: string                // e.g., "Ether"
    readonly symbol: string              // e.g., "ETH"
    readonly decimals: number            // Usually 18
  }
  readonly blockTime: number             // Average block time in ms
  readonly rpcUrls: {
    readonly default: { readonly http: readonly string[] }
  }
  readonly blockExplorers?: {
    readonly default: {
      readonly name: string
      readonly url: string
      readonly apiUrl?: string
    }
  }
  readonly contracts?: {
    readonly multicall3?: ChainContract
    readonly ensRegistry?: ChainContract
    readonly ensUniversalResolver?: ChainContract
  }
  readonly testnet?: boolean
}

interface ChainContract {
  readonly address: `0x${string}`
  readonly blockCreated?: number
}
```

## Custom Chain Creation

Create custom chain configurations using `Layer.succeed`:

```typescript
import { Layer } from 'effect'
import { ChainService, ChainConfig } from 'voltaire-effect/services'

const myChain = Layer.succeed(ChainService, {
  id: 12345,
  name: 'My Chain',
  nativeCurrency: { name: 'Token', symbol: 'TKN', decimals: 18 },
  blockTime: 2000,
  rpcUrls: { default: { http: ['https://rpc.mychain.io'] } },
  contracts: {
    multicall3: {
      address: '0xcA11bde05977b3631167028862bE2a173976CA11',
      blockCreated: 1
    }
  }
} satisfies ChainConfig)
```

## Usage with Other Services

Chain configuration is used by other services for chain-specific behavior:

```typescript
import { Effect, Layer } from 'effect'
import { 
  ChainService, 
  ProviderService, 
  Provider, 
  HttpTransport,
  mainnet 
} from 'voltaire-effect/services'

const program = Effect.gen(function* () {
  const chain = yield* ChainService
  const provider = yield* ProviderService
  
  // Use chain-specific data
  const multicall = chain.contracts?.multicall3?.address
  const blockNumber = yield* provider.getBlockNumber()
  
  return { chain: chain.name, multicall, blockNumber }
}).pipe(
  Effect.provide(Layer.merge(
    Provider.pipe(Layer.provide(HttpTransport('https://eth.llamarpc.com'))),
    mainnet
  ))
)
```

## Service Interface

```typescript
// ChainService is a Context.Tag that provides ChainConfig directly
class ChainService extends Context.Tag("ChainService")<
  ChainService,
  ChainConfig
>() {}
```
