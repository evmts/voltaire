---
title: WalletClient Service
description: Transaction signing and sending with Effect.ts
---

## Quick Start

```typescript
import { Effect } from 'effect'
import { 
  WalletClientService, WalletClientLive, LocalAccount,
  PublicClient, HttpTransport, Secp256k1Live, KeccakLive
} from 'voltaire-effect/services'
import { Hex } from '@tevm/voltaire'

const privateKey = Hex.fromHex('0xac0974bec...')

const program = Effect.gen(function* () {
  const wallet = yield* WalletClientService
  return yield* wallet.sendTransaction({
    to: recipientAddress,
    value: 1000000000000000000n
  })
}).pipe(
  Effect.provide(WalletClientLive),
  Effect.provide(LocalAccount(privateKey)),
  Effect.provide(Secp256k1Live),
  Effect.provide(KeccakLive),
  Effect.provide(PublicClient),
  Effect.provide(HttpTransport('https://eth.llamarpc.com'))
)
```

## Browser Wallet

```typescript
import { JsonRpcAccount, BrowserTransport } from 'voltaire-effect/services'

const program = Effect.gen(function* () {
  const wallet = yield* WalletClientService
  const accounts = yield* wallet.requestAddresses() // triggers popup
  const txHash = yield* wallet.sendTransaction({ to, value })
  return txHash
}).pipe(
  Effect.provide(WalletClientLive),
  Effect.provide(JsonRpcAccount(userAddress)),
  Effect.provide(PublicClient),
  Effect.provide(BrowserTransport)
)
```

## Methods

**signMessage** — EIP-191 personal_sign
```typescript
const signature = yield* wallet.signMessage(Hex.fromString('Hello!'))
```

**signTransaction** — Sign without broadcast (auto-fills nonce, gas, chainId)
```typescript
const signedTx = yield* wallet.signTransaction({ to, value })
```

**signTypedData** — EIP-712 structured data
```typescript
const sig = yield* wallet.signTypedData({
  domain: { name: 'App', version: '1', chainId: 1n },
  primaryType: 'Order',
  types: { Order: [{ name: 'amount', type: 'uint256' }] },
  message: { amount: 1000n }
})
```

**sendTransaction** — Sign and broadcast
```typescript
const txHash = yield* wallet.sendTransaction({ to, value: 1000000000000000000n })
```

**sendRawTransaction** — Broadcast pre-signed tx
```typescript
const txHash = yield* wallet.sendRawTransaction(signedTxHex)
```

**requestAddresses** — Get connected accounts (browser popup)
```typescript
const accounts = yield* wallet.requestAddresses()
```

**switchChain** — Change network
```typescript
yield* wallet.switchChain(137) // Polygon
```

## TransactionRequest

```typescript
type TransactionRequest = {
  readonly to?: AddressType | null     // null = contract deploy
  readonly value?: bigint
  readonly data?: HexType
  readonly nonce?: bigint              // auto-filled
  readonly gasLimit?: bigint           // auto-estimated
  readonly gasPrice?: bigint           // legacy
  readonly maxFeePerGas?: bigint       // EIP-1559
  readonly maxPriorityFeePerGas?: bigint
  readonly chainId?: bigint            // auto-detected
}
```

## Error Handling

```typescript
import { WalletClientError } from 'voltaire-effect/services'

program.pipe(
  Effect.catchTag('WalletClientError', (e) => {
    if (e.message.includes('insufficient funds')) return Effect.fail(e)
    if (e.message.includes('rejected')) return Effect.fail(e)
    return Effect.fail(e)
  })
)
```

## Service Interface

```typescript
type WalletClientShape = {
  readonly signMessage: (message: HexType) => Effect.Effect<SignatureType, WalletClientError>
  readonly signTransaction: (tx: TransactionRequest) => Effect.Effect<HexType, WalletClientError>
  readonly signTypedData: (typedData: TypedDataType) => Effect.Effect<SignatureType, WalletClientError>
  readonly sendTransaction: (tx: TransactionRequest) => Effect.Effect<HexType, WalletClientError>
  readonly sendRawTransaction: (signedTx: HexType) => Effect.Effect<HexType, WalletClientError>
  readonly requestAddresses: () => Effect.Effect<AddressType[], WalletClientError>
  readonly switchChain: (chainId: number) => Effect.Effect<void, WalletClientError>
}
```
