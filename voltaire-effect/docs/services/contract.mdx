---
title: Contract Service
description: Type-safe contract interaction with Effect.ts
---

## Quick Start

```typescript
import { Contract, PublicClient, HttpTransport } from 'voltaire-effect/services'
import { Effect } from 'effect'

const erc20Abi = [
  { type: 'function', name: 'balanceOf', stateMutability: 'view',
    inputs: [{ name: 'account', type: 'address' }],
    outputs: [{ name: 'balance', type: 'uint256' }] },
  { type: 'function', name: 'transfer', stateMutability: 'nonpayable',
    inputs: [{ name: 'to', type: 'address' }, { name: 'amount', type: 'uint256' }],
    outputs: [{ name: 'success', type: 'bool' }] },
] as const

const program = Effect.gen(function* () {
  const dai = yield* Contract(daiAddress, erc20Abi)
  const balance = yield* dai.read.balanceOf(userAddress)
  return balance
}).pipe(
  Effect.provide(PublicClient),
  Effect.provide(HttpTransport('https://eth.llamarpc.com'))
)
```

## Read

View/pure functions via `eth_call`. No wallet required.

```typescript
const balance = yield* contract.read.balanceOf(userAddress)
```

## Write

State-changing functions. Requires `WalletClientService`.

```typescript
const txHash = yield* contract.write.transfer(recipientAddress, 1000n)
```

## Simulate

Test writes without sending.

```typescript
const success = yield* contract.simulate.transfer(recipientAddress, 1000n)
```

## Events

```typescript
const transfers = yield* contract.getEvents('Transfer', {
  fromBlock: 18000000n,
  toBlock: 'latest',
  args: { from: userAddress }
})
```

## Type Safety

Types inferred from ABI:

```typescript
contract.read.balanceOf(address)     // ✅ takes address
contract.read.balanceOf(123n)        // ❌ type error
contract.write.transfer(to, amount)  // ✅ write method
contract.write.balanceOf(address)    // ❌ balanceOf is view
```

## Error Handling

```typescript
import { ContractCallError, ContractWriteError } from 'voltaire-effect/services'

program.pipe(
  Effect.catchTag('ContractCallError', (e) => Effect.succeed({ error: e.message })),
  Effect.catchTag('ContractWriteError', (e) => Effect.succeed({ error: e.message }))
)
```
