```typescript
import { Effect, Layer } from 'effect'
import { ProviderService } from 'voltaire-effect'
import { CryptoTest } from 'voltaire-effect/crypto'

// Mock provider with controlled responses
const MockProvider = Layer.succeed(ProviderService, {
  request: (method: string, _params?: unknown[]) => {
    switch (method) {
      case 'eth_blockNumber':
        return Effect.succeed('0x3039') // 12345
      case 'eth_getBalance':
        return Effect.succeed('0xde0b6b3a7640000') // 1 ETH
      case 'eth_getBlockByNumber':
        return Effect.succeed({ number: '0x3039', hash: '0x...' })
      default:
        return Effect.succeed(null)
    }
  }
})

// Combine mock layers
const TestLayer = Layer.mergeAll(
  MockProvider,
  CryptoTest
)

// Run tests with mock layer
await Effect.runPromise(program.pipe(Effect.provide(TestLayer)))
```
